

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>exoplasim &mdash; ExoPlaSim 2.0.4 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> ExoPlaSim
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../source/exoplasim.html">exoplasim package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/modules.html">exoplasim</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ExoPlaSim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>exoplasim</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for exoplasim</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="k">global</span> <span class="n">sourcedir</span>
<span class="n">sourcedir</span> <span class="o">=</span> <span class="kc">None</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">netCDF4</span> <span class="k">as</span> <span class="nn">nc</span>
<span class="kn">import</span> <span class="nn">exoplasim.gcmt</span>

<span class="n">smws</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mH2&#39;</span><span class="p">:</span> <span class="mf">2.01588</span><span class="p">,</span>
        <span class="s1">&#39;mHe&#39;</span><span class="p">:</span> <span class="mf">4.002602</span><span class="p">,</span>
        <span class="s1">&#39;mN2&#39;</span><span class="p">:</span> <span class="mf">28.0134</span><span class="p">,</span>
        <span class="s1">&#39;mO2&#39;</span><span class="p">:</span> <span class="mf">31.9988</span><span class="p">,</span>
        <span class="s1">&#39;mCO2&#39;</span><span class="p">:</span><span class="mf">44.01</span><span class="p">,</span>
        <span class="s1">&#39;mAr&#39;</span><span class="p">:</span> <span class="mf">39.948</span><span class="p">,</span>
        <span class="s1">&#39;mNe&#39;</span><span class="p">:</span> <span class="mf">20.1797</span><span class="p">,</span>
        <span class="s1">&#39;mKr&#39;</span><span class="p">:</span> <span class="mf">83.798</span><span class="p">,</span>
        <span class="s1">&#39;mH2O&#39;</span><span class="p">:</span><span class="mf">18.01528</span><span class="p">}</span>

<span class="n">gases_default</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pH2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;pHe&#39;</span><span class="p">:</span> <span class="mf">5.24e-6</span><span class="p">,</span>
                <span class="s1">&#39;pN2&#39;</span><span class="p">:</span> <span class="mf">0.78084</span><span class="p">,</span>
                <span class="s1">&#39;pO2&#39;</span><span class="p">:</span> <span class="mf">0.20946</span><span class="p">,</span>
                <span class="s1">&#39;pCO2&#39;</span><span class="p">:</span><span class="mf">330.0e-6</span><span class="p">,</span>
                <span class="s1">&#39;pAr&#39;</span><span class="p">:</span> <span class="mf">9.34e-3</span><span class="p">,</span>
                <span class="s1">&#39;pNe&#39;</span><span class="p">:</span> <span class="mf">18.18e-6</span><span class="p">,</span>
                <span class="s1">&#39;pKr&#39;</span><span class="p">:</span> <span class="mf">1.14e-6</span><span class="p">,</span>
                <span class="s1">&#39;pH2O&#39;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">_noneparse</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">dtype</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">text</span><span class="o">==</span><span class="s2">&quot;None&quot;</span> <span class="ow">or</span> <span class="n">text</span><span class="o">==</span><span class="s2">&quot;none&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dtype</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    
<span class="c1">#def readsourcepath():</span>
    <span class="c1">#with open(&quot;sourcepath&quot;,&quot;r&quot;) as sf:</span>
        <span class="c1">#spth = sf.read()</span>
        <span class="c1">#if spth.strip()==&quot;None&quot;:</span>
            <span class="c1">#sourcedir=None</span>
        <span class="c1">#else:</span>
            <span class="c1">#sourcedir=spth.strip()</span>
            
    <span class="c1">#return sourcedir</span>

<div class="viewcode-block" id="Model"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model">[docs]</a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create an ExoPlaSim model in a particular directory.</span>
<span class="sd">            </span>
<span class="sd">    Initialize an ExoPlaSim model in a particular directory. </span>
<span class="sd">    If the necessary executable does not yet exist, compile it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    resolution : str, optional</span>
<span class="sd">        The resolution of the model. Options are T21, T42, T63, T85, </span>
<span class="sd">        T106, T127, and T170, corresponding to 32, 64, 96, 128, 160, </span>
<span class="sd">        192, and 256 latitudes respectively, and twice as many </span>
<span class="sd">        longitudes. ExoPlaSim has been tested and validated most </span>
<span class="sd">        extensively at T21 and T42. Higher resolutions will take </span>
<span class="sd">        considerable time to run.</span>
<span class="sd">    layers : int, optional</span>
<span class="sd">        The number of vertical layers in the model atmosphere. The default</span>
<span class="sd">        is 10, but PlaSim has been used with 5 layers in many studies.</span>
<span class="sd">        More layers are supported, but not recommended except at higher</span>
<span class="sd">        resolutions.</span>
<span class="sd">    ncpus : int, optional</span>
<span class="sd">        The number of MPI processes to use, typically the number of cores</span>
<span class="sd">        available. If ncpus=1, MPI will not be used.</span>
<span class="sd">    precision : int, optional</span>
<span class="sd">        Either 4 or 8--specifies the number of bytes for a Fortran real.</span>
<span class="sd">    debug : bool, optional</span>
<span class="sd">        If True, compiler optimizations are disabled</span>
<span class="sd">        and the code is compiled with debugging flags enabled that will</span>
<span class="sd">        allow line-by-line tracebacks if ExoPlaSim crashes. Only use for</span>
<span class="sd">        development purposes.</span>
<span class="sd">    inityear : int, optional</span>
<span class="sd">        The number to use for the initial model year (default 0).</span>
<span class="sd">    recompile : bool, optional</span>
<span class="sd">        True/False flag used to force a recompile. Cannot force the </span>
<span class="sd">        model to skip compilation if the executable does not exist or</span>
<span class="sd">        compilation-inducing flags are set.</span>
<span class="sd">    optimization : str, optional</span>
<span class="sd">        Fortran compiler arguments for optimization. ANY compiler</span>
<span class="sd">        flags can be passed here, but it&#39;s intended for optimization</span>
<span class="sd">        flags. Setting this will trigger a recompile.</span>
<span class="sd">    mars : bool, optional</span>
<span class="sd">        True/False. If True, will use Mars-specific routines.</span>
<span class="sd">    workdir : str, optional</span>
<span class="sd">        The directory in which to construct the model.</span>
<span class="sd">    source : str, optional</span>
<span class="sd">        The directory in which to look for executables, namelists, </span>
<span class="sd">        boundary conditions, etc. If not set, will default to exoplasim/plasim/run/.        </span>
<span class="sd">    modelname : str, optional </span>
<span class="sd">        The name to use for the model and its output files when finished.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Model</span>
<span class="sd">        An instantiated Model object that resides in a directory with the namelists</span>
<span class="sd">        and executable necessary to run ExoPlaSim.</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import exoplasim as exo</span>
<span class="sd">    &gt;&gt;&gt; mymodel = exo.Model(workdir=&quot;mymodel_testrun&quot;,modelname=&quot;mymodel&quot;,resolution=&quot;T21&quot;,layers=10,ncpus=8)</span>
<span class="sd">    &gt;&gt;&gt; mymodel.configure()</span>
<span class="sd">    &gt;&gt;&gt; mymodel.exportcfg()</span>
<span class="sd">    &gt;&gt;&gt; mymodel.run(years=100,crashifbroken=True)</span>
<span class="sd">    &gt;&gt;&gt; mymodel.finalize(&quot;mymodel_output&quot;)</span>

<span class="sd">    In this example, we initialize a model that will run in the directory</span>
<span class="sd">    &quot;mymodel_testrun&quot;, and has the name &quot;mymodel&quot;, which will be used to</span>
<span class="sd">    label output and error logs. The model has T21 resolution, or 32x64,</span>
<span class="sd">    10 layers, and will run on 8 CPUs. By default, the compiler will use</span>
<span class="sd">    8-byte precision. 4-byte may run slightly faster, but possibly at the</span>
<span class="sd">    cost of reduced stability. If there are machine-specific optimization</span>
<span class="sd">    flags you would like to use when compiling, you may specify them as a</span>
<span class="sd">    string to the optimization argument, e.g. ``optimization=&#39;mavx&#39;``. ExoPlaSim</span>
<span class="sd">    will check to see if an appropriate executable has already been created,</span>
<span class="sd">    and if not (or if flags indicating special compiler behavior such as </span>
<span class="sd">    debug=True or an optimization flag are set) it will compile one. We then</span>
<span class="sd">    configure the model with all the default parameter choices, which means</span>
<span class="sd">    we will get a model of Earth. We then export the model configurations</span>
<span class="sd">    to a ``.cfg`` file (named automatically after the model), which will allow</span>
<span class="sd">    the model configuration to be recreated exactly by other users. We </span>
<span class="sd">    run the model for 100 years, with error-handling enabled. Finally, we </span>
<span class="sd">    tell the model to clean up after itself. It will take the most recent </span>
<span class="sd">    output files and rename them after the model name we chose, and delete </span>
<span class="sd">    all the intermediate output and configuration files. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">resolution</span><span class="o">=</span><span class="s2">&quot;T21&quot;</span><span class="p">,</span><span class="n">layers</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">ncpus</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">inityear</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">recompile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">optimization</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">workdir</span><span class="o">=</span><span class="s2">&quot;most&quot;</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">modelname</span><span class="o">=</span><span class="s2">&quot;MOST_EXP&quot;</span><span class="p">):</span>
        
        <span class="k">global</span> <span class="n">sourcedir</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcedir</span><span class="p">:</span> <span class="c1">#This means we haven&#39;t run yet, and have some post-install work to do</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;spth=$(python</span><span class="si">%s</span><span class="s1"> -c &quot;import exoplasim as exo; print(exo.__path__)&quot;) &amp;&amp; echo $spth&gt;sourcepath&#39;</span><span class="o">%</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;sourcepath&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">spf</span><span class="p">:</span>
                <span class="n">sourcedir</span> <span class="o">=</span> <span class="n">spf</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">sourcedir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;[&quot;</span><span class="p">:</span>
                    <span class="n">sourcedir</span><span class="o">=</span><span class="n">sourcedir</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">if</span> <span class="n">sourcedir</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;]&quot;</span><span class="p">:</span>
                    <span class="n">sourcedir</span><span class="o">=</span><span class="n">sourcedir</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">sourcedir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;&#39;&quot;</span><span class="p">:</span>
                    <span class="n">sourcedir</span><span class="o">=</span><span class="n">sourcedir</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">if</span> <span class="n">sourcedir</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;&#39;&quot;</span><span class="p">:</span>
                    <span class="n">sourcedir</span><span class="o">=</span><span class="n">sourcedir</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm sourcepath&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/__init__.py&quot;</span><span class="o">%</span><span class="n">sourcedir</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">sourcef</span><span class="p">:</span>
                <span class="n">sourcecode</span> <span class="o">=</span> <span class="n">sourcef</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">sourcecode</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sourcedir = &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span><span class="o">%</span><span class="n">sourcedir</span>
            <span class="n">sourcecode</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sourcecode</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2">/__init__.py </span><span class="si">%s</span><span class="s2">/preinit.py&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">sourcedir</span><span class="p">,</span><span class="n">sourcedir</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/__init__.py&quot;</span><span class="o">%</span><span class="n">sourcedir</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">sourcef</span><span class="p">:</span>
                    <span class="n">sourcef</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sourcecode</span><span class="p">)</span>
                <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
                <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">sourcedir</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;./configure.sh&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cd postprocessor &amp;&amp; ./build_init.sh &amp;&amp; &quot;</span><span class="o">+</span>
                        <span class="s2">&quot;cp burn7.x ../plasim/run/ &amp;&amp; cp burn7.x </span><span class="si">%s</span><span class="s2">/&quot;</span><span class="o">%</span><span class="n">source</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Hi! Welcome to ExoPlaSim. It looks like this is the first &quot;</span><span class="o">+</span>
                                    <span class="s2">&quot;time you&#39;re using this program since installing, and you &quot;</span><span class="o">+</span>
                                    <span class="s2">&quot;may have installed it to a location that needs root &quot;</span><span class="o">+</span>
                                    <span class="s2">&quot;privileges to modify. This is not ideal! If you want to &quot;</span><span class="o">+</span>
                                    <span class="s2">&quot;use the program this way, you will need to run python code&quot;</span><span class="o">+</span>
                                    <span class="s2">&quot; that uses ExoPlaSim with sudo privileges; i.e. sudo &quot;</span><span class="o">+</span>
                                    <span class="s2">&quot;python3 myscript.py. If you did this because pip install &quot;</span><span class="o">+</span>
                                    <span class="s2">&quot;breaks without sudo privileges, then try using </span><span class="se">\n\n\t</span><span class="s2">pip &quot;</span><span class="o">+</span> <span class="s2">&quot;install --user exoplasim </span><span class="se">\n\n</span><span class="s2">instead. It is generally a &quot;</span><span class="o">+</span>
                                    <span class="s2">&quot;very bad idea to install things with sudo pip install.&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">runscript</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">otherargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="o">=</span><span class="n">modelname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cleaned</span><span class="o">=</span><span class="kc">False</span>
        
        <span class="k">if</span> <span class="n">debug</span> <span class="ow">or</span> <span class="n">optimization</span><span class="p">:</span> <span class="c1">#There is no need to set these for precompiled binaries</span>
            <span class="n">recompile</span><span class="o">=</span><span class="kc">True</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ncpus</span> <span class="o">=</span> <span class="n">ncpus</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncpus</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exec</span> <span class="o">=</span> <span class="s2">&quot;mpiexec -np </span><span class="si">%d</span><span class="s2"> &quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">ncpus</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exec</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">layers</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">odir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">workdir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;/&quot;</span><span class="p">:</span>
            <span class="n">workdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">odir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">workdir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workdir</span> <span class="o">=</span> <span class="n">workdir</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mkdir &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span><span class="o">=</span><span class="n">inityear</span>
        
        <span class="c1"># Depending on how the user has entered the resolution, set the appropriate number</span>
        <span class="c1"># of spectral modes and latitudes</span>
        <span class="k">if</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;T21&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;t21&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">21</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">32</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nsp</span><span class="o">=</span><span class="mi">21</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlats</span><span class="o">=</span><span class="mi">32</span>
        <span class="k">elif</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;T42&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;t42&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">42</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">64</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nsp</span><span class="o">=</span><span class="mi">42</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlats</span><span class="o">=</span><span class="mi">64</span>
        <span class="k">elif</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;T63&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;t63&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">63</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">96</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nsp</span><span class="o">=</span><span class="mi">63</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlats</span><span class="o">=</span><span class="mi">96</span>
        <span class="k">elif</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;T85&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;t85&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">85</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">128</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nsp</span><span class="o">=</span><span class="mi">85</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlats</span><span class="o">=</span><span class="mi">128</span>
        <span class="k">elif</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;T106&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;T106&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">106</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">160</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nsp</span><span class="o">=</span><span class="mi">106</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlats</span><span class="o">=</span><span class="mi">160</span>
        <span class="k">elif</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;T127&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;t127&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">127</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">192</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nsp</span><span class="o">=</span><span class="mi">127</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlats</span><span class="o">=</span><span class="mi">192</span>
        <span class="k">elif</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;T170&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="s2">&quot;t170&quot;</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">170</span> <span class="ow">or</span> <span class="n">resolution</span><span class="o">==</span><span class="mi">256</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nsp</span><span class="o">=</span><span class="mi">170</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlats</span><span class="o">=</span><span class="mi">256</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Resolution unsupported. ExoPlaSim supports T21, T42, T63, T85, &quot;</span><span class="o">+</span>
                            <span class="s2">&quot;T106, T127, and T170 (32, 64, 96, 128, 160, 192, and 256 &quot;</span><span class="o">+</span>
                            <span class="s2">&quot;latitudes respectively&quot;</span><span class="p">)</span>
        
        <span class="c1"># If the executable does not exist, then regardless of whether we&#39;ve been asked</span>
        <span class="c1"># to recompile, we&#39;ll have to recompile</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">source</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/plasim/run&quot;</span><span class="o">%</span><span class="n">sourcedir</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">executable</span> <span class="o">=</span> <span class="n">source</span><span class="o">+</span><span class="s2">&quot;/most_plasim_t</span><span class="si">%d</span><span class="s2">_l</span><span class="si">%d</span><span class="s2">_p</span><span class="si">%d</span><span class="s2">.x&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nsp</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span><span class="n">ncpus</span><span class="p">)</span>
        
        <span class="n">burnsource</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/postprocessor&quot;</span><span class="o">%</span><span class="n">sourcedir</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Checking for </span><span class="si">%s</span><span class="s2">....&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">executable</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">recompile</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">executable</span><span class="p">):</span>
            <span class="n">extraflags</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="n">extraflags</span><span class="o">+=</span> <span class="s2">&quot;-d &quot;</span>
            <span class="k">if</span> <span class="n">optimization</span><span class="p">:</span>
                <span class="n">extraflags</span><span class="o">+=</span> <span class="s2">&quot;-O </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">optimization</span>
            <span class="k">if</span> <span class="n">mars</span><span class="p">:</span>
                <span class="n">extraflags</span><span class="o">+=</span> <span class="s2">&quot;-m &quot;</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cwd=$(pwd) &amp;&amp; &quot;</span><span class="o">+</span>
                    <span class="s2">&quot;cd </span><span class="si">%s</span><span class="s2"> &amp;&amp; ./compile.sh -n </span><span class="si">%d</span><span class="s2"> -p </span><span class="si">%d</span><span class="s2"> -r T</span><span class="si">%d</span><span class="s2"> -v </span><span class="si">%d</span><span class="s2"> &quot;</span><span class="o">%</span><span class="p">(</span><span class="n">sourcedir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ncpus</span><span class="p">,</span>
                                                                        <span class="n">precision</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nsp</span><span class="p">,</span>
                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span><span class="o">+</span>
                    <span class="n">extraflags</span><span class="o">+</span><span class="s2">&quot; &amp;&amp;&quot;</span><span class="o">+</span>
                    <span class="s2">&quot;cd $cwd&quot;</span><span class="p">)</span>
        
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2">/* </span><span class="si">%s</span><span class="s2">/&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2">/burn7.x </span><span class="si">%s</span><span class="s2">/&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">burnsource</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
        
        <span class="c1">#Copy the executable to the working directory, and then CD there</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
        <span class="c1">#os.chdir(self.workdir)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">executable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">executable</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#Strip off all the preceding path</span>
        
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crashdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">odir</span><span class="p">)</span>
    
        
<div class="viewcode-block" id="Model.run"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run the Model&#39;s designated run routine.</span>

<span class="sd">        This may have been passed as runscript when the model was</span>
<span class="sd">        created, or it could be the model&#39;s internal ._run() routine. </span>
<span class="sd">        That method takes the following arguments:</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        years : int, optional</span>
<span class="sd">            Number of years to run    </span>
<span class="sd">        postprocess : bool, optional</span>
<span class="sd">            True/False. Whether or not NetCDF files should be produced on-the-fly</span>
<span class="sd">        crashifbroken : bool, optional</span>
<span class="sd">            True/False. If True, use Pythonic error handling    </span>
<span class="sd">        clean : bool, optional</span>
<span class="sd">            True/False. If True, delete raw output files once NetCDF files are made</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">runscript</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">runscript</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="c1">#runscript MUST accept a Model object as the first arg</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_crash</span><span class="p">()</span></div>
    
    <span class="k">def</span> <span class="nf">_checktimes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get list of durations for each year computed so far.&quot;&quot;&quot;</span>
        <span class="n">diagfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/*DIAG*&quot;</span><span class="p">)</span>
        <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">diagfiles</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">diagf</span><span class="p">:</span>
                <span class="n">diag</span> <span class="o">=</span> <span class="n">diagf</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">elapsed</span><span class="o">=</span><span class="mf">1.0e6</span> <span class="c1">#Assume a large value so we stop if there&#39;s a problem.</span>
            <span class="n">found</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;Seconds per sim year&quot;</span> <span class="ow">in</span> <span class="n">diag</span><span class="p">[</span><span class="n">ln</span><span class="p">]:</span>
                    <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">diag</span><span class="p">[</span><span class="n">ln</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="c1">#seconds</span>
                    <span class="n">found</span><span class="o">=</span><span class="kc">True</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="s2">&quot;Minutes per sim year&quot;</span> <span class="ow">in</span> <span class="n">diag</span><span class="p">[</span><span class="n">ln</span><span class="p">]:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">elapsed</span> <span class="o">=</span><span class="n">diag</span><span class="p">[</span><span class="n">ln</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
                            <span class="n">elapsed</span> <span class="o">=</span> <span class="n">elapsed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
                            <span class="n">elapsed</span> <span class="o">=</span> <span class="n">elapsed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                            <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">elapsed</span><span class="p">)</span><span class="o">*</span><span class="mf">60.0</span> 
                                                                                <span class="c1">#seconds</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">raise</span> 
                        <span class="n">found</span><span class="o">=</span><span class="kc">True</span>
                        <span class="k">break</span>
                
            <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elapsed</span><span class="o">/</span><span class="mf">60.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">times</span>
            
    
    <span class="k">def</span> <span class="nf">_checktime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">year</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get walltime duration for a given year of output.&quot;&quot;&quot;</span>
        <span class="n">diagfiles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/*DIAG*&quot;</span><span class="p">))</span>
        <span class="n">recent</span> <span class="o">=</span> <span class="n">diagfiles</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">recent</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">diagf</span><span class="p">:</span>
            <span class="n">diag</span> <span class="o">=</span> <span class="n">diagf</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">elapsed</span><span class="o">=</span><span class="mf">1.0e6</span> <span class="c1">#Assume a large value so we stop if there&#39;s a problem.</span>
        <span class="n">found</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;Seconds per sim year&quot;</span> <span class="ow">in</span> <span class="n">diag</span><span class="p">[</span><span class="n">ln</span><span class="p">]:</span>
                <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">diag</span><span class="p">[</span><span class="n">ln</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="c1">#seconds</span>
                <span class="n">found</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;Minutes per sim year&quot;</span> <span class="ow">in</span> <span class="n">diag</span><span class="p">[</span><span class="n">ln</span><span class="p">]:</span>
                    <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">diag</span><span class="p">[</span><span class="n">ln</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span><span class="o">*</span><span class="mf">60.0</span> 
                                                                            <span class="c1">#seconds</span>
                    <span class="n">found</span><span class="o">=</span><span class="kc">True</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">elapsed</span><span class="o">/</span><span class="mf">60.0</span> <span class="c1">#convert to minutes</span>
        
        
<div class="viewcode-block" id="Model.runtobalance"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.runtobalance">[docs]</a>    <span class="k">def</span> <span class="nf">runtobalance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">threshold</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">maxyears</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">minyears</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
                    <span class="n">timelimit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">crashifbroken</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Run the model until energy balance equilibrium is reached at the top and surface.</span>
<span class="sd">            </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        threshold : float, optional</span>
<span class="sd">            If specified, overrides the threshold set by ``.config()``. The model will run</span>
<span class="sd">            until the energy balance at the top and surface drifts by less than this</span>
<span class="sd">            amount per year over a given baseline.</span>
<span class="sd">        baseline : int, optional</span>
<span class="sd">            The number of years over which to evaluate energy balance drift. Default 50</span>
<span class="sd">        maxyears : int, optional</span>
<span class="sd">            The maximum number of years to run before returning. Default 300. This is</span>
<span class="sd">            useful if you are running on a scratch disk with limited space.</span>
<span class="sd">        minyears : int, optional</span>
<span class="sd">            The minimum number of years to run before determining that the model is in</span>
<span class="sd">            equilibrium.</span>
<span class="sd">        timelimit : float, optional</span>
<span class="sd">            If set, maxyears will be revised each year based on the average minutes</span>
<span class="sd">            per year thus far, to try to avoid going over the time limit, which should</span>
<span class="sd">            be given in minutes.</span>
<span class="sd">        crashifbroken : bool, optional</span>
<span class="sd">            True/False. If True, Pythonic error handling is enabled. Default True.</span>
<span class="sd">        clean : bool, optional</span>
<span class="sd">            True/False. If True, raw output is deleted once postprocessed. Default True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the model reached equilibrium, False if not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">runlimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span><span class="o">+</span><span class="n">maxyears</span>
        <span class="k">if</span> <span class="n">threshold</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
        <span class="n">ogrunlimit</span> <span class="o">=</span> <span class="n">runlimit</span>
        <span class="n">ogminyears</span> <span class="o">=</span> <span class="n">minyears</span>
        <span class="n">runstart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mkdir snapshots&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mkdir highcadence&quot;</span><span class="p">)</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isbalanced</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="n">baseline</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span><span class="o">&lt;</span><span class="n">minyears</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span><span class="o">&lt;</span><span class="n">runlimit</span><span class="p">:</span>
            <span class="n">dataname</span><span class="o">=</span><span class="s2">&quot;MOST.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">snapname</span><span class="o">=</span><span class="s2">&quot;MOST_SNAP.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">hcname</span>  <span class="o">=</span><span class="s2">&quot;MOST_HC.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">diagname</span><span class="o">=</span><span class="s2">&quot;MOST_DIAG.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">restname</span><span class="o">=</span><span class="s2">&quot;MOST_REST.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">snowname</span><span class="o">=</span><span class="s2">&quot;MOST_SNOW.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">stormname</span><span class="o">=</span><span class="s2">&quot;MOST.</span><span class="si">%05d</span><span class="s2">.STORM&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            
            <span class="c1">#Run ExoPlaSim</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exec</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">executable</span><span class="p">)</span>
            
            <span class="c1">#Sort, categorize, and arrange the various outputs</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e restart_dsnow ] &amp;&amp; rm restart_dsnow&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e restart_xsnow ] &amp;&amp; rm restart_xsnow&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e Abort_Message ] &amp;&amp; exit 1&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e plasim_output ] &amp;&amp; mv plasim_output &quot;</span><span class="o">+</span><span class="n">dataname</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e plasim_snapshot ] &amp;&amp; mv plasim_snapshot &quot;</span><span class="o">+</span><span class="n">snapname</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e plasim_hcadence ] &amp;&amp; mv plasim_hcadence &quot;</span><span class="o">+</span><span class="n">hcname</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e plasim_diag ] &amp;&amp; mv plasim_diag &quot;</span><span class="o">+</span><span class="n">diagname</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e plasim_status ] &amp;&amp; cp plasim_status plasim_restart&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e plasim_status ] &amp;&amp; mv plasim_status &quot;</span><span class="o">+</span><span class="n">restname</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e restart_snow ] &amp;&amp; mv restart_snow &quot;</span><span class="o">+</span><span class="n">snowname</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e hurricane_indicators] &amp;&amp; mv hurricane_indicators &quot;</span><span class="o">+</span><span class="n">stormname</span><span class="p">)</span>
            
            <span class="c1">#Do any additional work</span>
            <span class="n">timeavg</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">snapsht</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">highcdn</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">timeavg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">dataname</span><span class="p">,</span><span class="s2">&quot;example.nl&quot;</span><span class="p">,</span>
                                        <span class="n">log</span><span class="o">=</span><span class="s2">&quot;burnout&quot;</span><span class="p">,</span><span class="n">crashifbroken</span><span class="o">=</span><span class="n">crashifbroken</span><span class="p">)</span>
                <span class="n">snapsht</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">snapname</span><span class="p">,</span><span class="s2">&quot;snapshot.nl&quot;</span><span class="p">,</span>
                                        <span class="n">log</span><span class="o">=</span><span class="s2">&quot;snapout&quot;</span><span class="p">,</span><span class="n">crashifbroken</span><span class="o">=</span><span class="n">crashifbroken</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mv </span><span class="si">%s</span><span class="s2">.nc snapshots/&quot;</span><span class="o">%</span><span class="n">snapname</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]:</span>
                    <span class="n">highcdn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">hcname</span>  <span class="p">,</span><span class="s2">&quot;snapshot.nl&quot;</span><span class="p">,</span>
                                            <span class="n">log</span><span class="o">=</span><span class="s2">&quot;hcout&quot;</span>  <span class="p">,</span><span class="n">crashifbroken</span><span class="o">=</span><span class="n">crashifbroken</span><span class="p">)</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mv </span><span class="si">%s</span><span class="s2">.nc highcadence/&quot;</span><span class="o">%</span><span class="n">hcname</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_crash</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">clean</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">timeavg</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">dataname</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">snapsht</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">snapname</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">highcdn</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">hcname</span><span class="p">)</span>
                    
            <span class="k">if</span> <span class="n">crashifbroken</span><span class="p">:</span> <span class="c1">#Check to see that we aren&#39;t throwing NaNs</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">check</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">integritycheck</span><span class="p">(</span><span class="n">dataname</span><span class="o">+</span><span class="s2">&quot;.nc&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_crash</span><span class="p">()</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">sb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getbalance</span><span class="p">(</span><span class="s2">&quot;hfns&quot;</span><span class="p">)</span>
            <span class="n">tb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getbalance</span><span class="p">(</span><span class="s2">&quot;ntr&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;echo </span><span class="si">%02.6f</span><span class="s2">  </span><span class="si">%02.6f</span><span class="s2">&#39;&gt;&gt;</span><span class="si">%s</span><span class="s2">/balance.log&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span><span class="n">tb</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
            
            <span class="k">if</span> <span class="n">timelimit</span><span class="p">:</span>
                <span class="n">avgyear</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checktimes</span><span class="p">()</span>
                <span class="n">runlimit</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">runstart</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">timelimit</span><span class="o">//</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">avgyear</span><span class="p">)),</span><span class="n">ogrunlimit</span><span class="p">)</span>
                <span class="n">minyears</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ogminyears</span><span class="p">,</span><span class="n">runlimit</span><span class="p">)</span>
            
        <span class="n">bott</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gethistory</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;hfns&quot;</span><span class="p">)</span>
        <span class="n">topt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gethistory</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;ntr&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/shistory.pso&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="s2">&quot;a+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">text</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bott</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/toahistory.pso&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="s2">&quot;a+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">text</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">topt</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">finished</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isbalanced</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="n">baseline</span><span class="p">)</span>
        <span class="n">finished</span> <span class="o">*=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span><span class="o">&gt;</span><span class="n">ogminyears</span><span class="p">)</span> <span class="c1">#Must be both</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">finished</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>
    
            
<div class="viewcode-block" id="Model.getbalance"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.getbalance">[docs]</a>    <span class="k">def</span> <span class="nf">getbalance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="n">year</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the global annual mean of a given variable for a given year</span>
<span class="sd">            </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The output variable string to return</span>
<span class="sd">        year : int, optional</span>
<span class="sd">            Which year to go to for output</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Global annual mean of requested quantity</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">savg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">tavg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">var</span></div>
    
<div class="viewcode-block" id="Model.gethistory"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.gethistory">[docs]</a>    <span class="k">def</span> <span class="nf">gethistory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;ts&quot;</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">layer</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the an array of global annual means of a given variable for each year</span>
<span class="sd">            </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str, optional</span>
<span class="sd">            The output variable string to return</span>
<span class="sd">        mean : bool, optional</span>
<span class="sd">            Toggle whether we return the mean or the sum</span>
<span class="sd">        year : int, optional</span>
<span class="sd">            Which year to go to for output</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>
<span class="sd">            1-D Array of global annual means</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/MOST*.nc&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
        <span class="n">dd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)):</span>
            <span class="n">ncd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">variable</span> <span class="o">=</span> <span class="n">ncd</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">key</span><span class="p">][:]</span>
            <span class="n">lon</span> <span class="o">=</span> <span class="n">ncd</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">][:]</span>
            <span class="n">lat</span> <span class="o">=</span> <span class="n">ncd</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">][:]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span><span class="p">[:,</span><span class="n">layer</span><span class="p">,:,:]</span>
            <span class="n">dd</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcmt</span><span class="o">.</span><span class="n">spatialmath</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span>
                                    <span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
            <span class="n">ncd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">dd</span></div>
    
    
    <span class="k">def</span> <span class="nf">_isbalanced</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">threshold</span> <span class="o">=</span> <span class="mf">5.0e-4</span><span class="p">,</span><span class="n">baseline</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether or not the model is in energy balance equilibrium</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        threshold : float, optional</span>
<span class="sd">            The maximum annual energetic drift allowed on the given baseline in W/m^2</span>
<span class="sd">        baseline : int, optional</span>
<span class="sd">            The number of years over which to assess energy balance</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether or not the model is in energy balance equilibrium</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nfiles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">((</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/MOST*.nc&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)))</span>
        <span class="n">prior</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/toahistory.ps*&quot;</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">toahistory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/toahistory.pso&quot;</span><span class="p">)</span>
                <span class="n">nfiles</span><span class="o">+=</span><span class="nb">len</span><span class="p">(</span><span class="n">toahistory</span><span class="p">)</span>
                <span class="n">shistory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/shistory.pso&quot;</span><span class="p">)</span>
                <span class="n">prior</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="n">sbalance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nfiles</span><span class="p">)</span>
        <span class="n">toabalance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nfiles</span><span class="p">)</span>
        <span class="n">nstart</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">if</span> <span class="n">prior</span><span class="p">:</span>
            <span class="n">sbalance</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">toahistory</span><span class="p">)]</span> <span class="o">=</span> <span class="n">shistory</span><span class="p">[:]</span>
            <span class="n">toabalance</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">toahistory</span><span class="p">)]</span> <span class="o">=</span> <span class="n">toahistory</span><span class="p">[:]</span>
            <span class="n">nstart</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">toahistory</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span> <span class="o">&lt;</span> <span class="n">baseline</span><span class="p">:</span> <span class="c1">#Run for minimum of baseline years</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span><span class="p">):</span>
                <span class="n">topt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getbalance</span><span class="p">(</span><span class="s2">&quot;ntr&quot;</span><span class="p">,</span><span class="n">year</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
                <span class="n">bott</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getbalance</span><span class="p">(</span><span class="s2">&quot;hfns&quot;</span><span class="p">,</span><span class="n">year</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
                <span class="n">sbalance</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">nstart</span><span class="p">]</span> <span class="o">=</span> <span class="n">bott</span>
                <span class="n">toabalance</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">nstart</span><span class="p">]</span> <span class="o">=</span> <span class="n">topt</span>
            <span class="n">savgs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">tavgs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sbalance</span><span class="p">)):</span>
                <span class="n">savgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sbalance</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">9</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">])))</span> <span class="c1">#10-year average energy balance</span>
                <span class="n">tavgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">toabalance</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">9</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">])))</span>
            <span class="n">sslopes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">tslopes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">savgs</span><span class="p">)):</span> <span class="c1">#5-baseline slopes in distance from energy balance</span>
                <span class="n">sslopes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">savgs</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">tslopes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">tavgs</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">savgslope</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sslopes</span><span class="p">[</span><span class="o">-</span><span class="mi">30</span><span class="p">:]))</span> <span class="c1">#30-year average of 5-year slopes  </span>
            <span class="n">tavgslope</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tslopes</span><span class="p">[</span><span class="o">-</span><span class="mi">30</span><span class="p">:]))</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;echo &#39;</span><span class="si">%02.8f</span><span class="s2">  </span><span class="si">%02.8f</span><span class="s2">&#39;&gt;&gt;</span><span class="si">%s</span><span class="s2">/slopes.log&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">savgslope</span><span class="p">,</span><span class="n">tavgslope</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">savgslope</span><span class="o">&lt;</span><span class="n">threshold</span> <span class="ow">and</span> <span class="n">tavgslope</span><span class="o">&lt;</span><span class="n">threshold</span><span class="p">:</span> <span class="c1">#Both TOA and Surface are changing at average </span>
                <span class="k">return</span> <span class="kc">True</span>                                  <span class="c1"># of &lt;0.1 mW/m^2/yr on 45-year baselines</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        
    <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">years</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">postprocess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">crashifbroken</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run the model for a set number of years.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        years : int, optional</span>
<span class="sd">            Number of years to run    </span>
<span class="sd">        postprocess : bool, optional</span>
<span class="sd">            True/False. Whether or not NetCDF files should be produced on-the-fly</span>
<span class="sd">        crashifbroken : bool, optional</span>
<span class="sd">            True/False. If True, use Pythonic error handling    </span>
<span class="sd">        clean : bool, optional</span>
<span class="sd">            True/False. If True, delete raw output files once NetCDF files are made</span>
<span class="sd">            </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mkdir snapshots&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mkdir highcadence&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">years</span><span class="p">):</span>
            <span class="n">dataname</span><span class="o">=</span><span class="s2">&quot;MOST.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">snapname</span><span class="o">=</span><span class="s2">&quot;MOST_SNAP.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">hcname</span>  <span class="o">=</span><span class="s2">&quot;MOST_HC.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">diagname</span><span class="o">=</span><span class="s2">&quot;MOST_DIAG.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">restname</span><span class="o">=</span><span class="s2">&quot;MOST_REST.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">snowname</span><span class="o">=</span><span class="s2">&quot;MOST_SNOW.</span><span class="si">%05d</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            <span class="n">stormname</span><span class="o">=</span><span class="s2">&quot;MOST.</span><span class="si">%05d</span><span class="s2">.STORM&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span>
            
            <span class="c1">#Run ExoPlaSim</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exec</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">executable</span><span class="p">)</span>
            
            <span class="c1">#Sort, categorize, and arrange the various outputs</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e restart_dsnow ] &amp;&amp; rm restart_dsnow&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e restart_xsnow ] &amp;&amp; rm restart_xsnow&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e Abort_Message ] &amp;&amp; exit 1&quot;</span><span class="p">)</span>
            <span class="c1">#os.system(&quot;[ -e plasim_outpuft ] &amp;&amp; mv plasim_output &quot;+dataname)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e plasim_snapshot ] &amp;&amp; mv plasim_snapshot &quot;</span><span class="o">+</span><span class="n">snapname</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e plasim_hcadence ] &amp;&amp; mv plasim_hcadence &quot;</span><span class="o">+</span><span class="n">hcname</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e plasim_diag ] &amp;&amp; mv plasim_diag &quot;</span><span class="o">+</span><span class="n">diagname</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e plasim_status ] &amp;&amp; cp plasim_status plasim_restart&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e plasim_status ] &amp;&amp; mv plasim_status &quot;</span><span class="o">+</span><span class="n">restname</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e restart_snow ] &amp;&amp; mv restart_snow &quot;</span><span class="o">+</span><span class="n">snowname</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;[ -e hurricane_indicators ] &amp;&amp; mv hurricane_indicators &quot;</span><span class="o">+</span><span class="n">stormname</span><span class="p">)</span>
            
            <span class="c1">#Do any additional work</span>
            <span class="n">timeavg</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">snapsht</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">highcdn</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">if</span> <span class="n">postprocess</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">timeavg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">dataname</span><span class="p">,</span><span class="s2">&quot;example.nl&quot;</span><span class="p">,</span>
                                            <span class="n">log</span><span class="o">=</span><span class="s2">&quot;burnout&quot;</span><span class="p">,</span><span class="n">crashifbroken</span><span class="o">=</span><span class="n">crashifbroken</span><span class="p">)</span>
                    <span class="n">snapsht</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">snapname</span><span class="p">,</span><span class="s2">&quot;snapshot.nl&quot;</span><span class="p">,</span>
                                            <span class="n">log</span><span class="o">=</span><span class="s2">&quot;snapout&quot;</span><span class="p">,</span><span class="n">crashifbroken</span><span class="o">=</span><span class="n">crashifbroken</span><span class="p">)</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mv </span><span class="si">%s</span><span class="s2">.nc snapshots/&quot;</span><span class="o">%</span><span class="n">snapname</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]:</span>
                        <span class="n">highcdn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">hcname</span>  <span class="p">,</span><span class="s2">&quot;snapshot.nl&quot;</span><span class="p">,</span>
                                                <span class="n">log</span><span class="o">=</span><span class="s2">&quot;hcout&quot;</span>  <span class="p">,</span><span class="n">crashifbroken</span><span class="o">=</span><span class="n">crashifbroken</span><span class="p">)</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mv </span><span class="si">%s</span><span class="s2">.nc highcadence/&quot;</span><span class="o">%</span><span class="n">hcname</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_crash</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">clean</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">timeavg</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">dataname</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">snapsht</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">snapname</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">highcdn</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">hcname</span><span class="p">)</span>
                    
            <span class="k">if</span> <span class="n">crashifbroken</span><span class="p">:</span> <span class="c1">#Check to see that we aren&#39;t throwing NaNs</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">check</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">integritycheck</span><span class="p">(</span><span class="n">dataname</span><span class="o">+</span><span class="s2">&quot;.nc&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_crash</span><span class="p">()</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">currentyear</span> <span class="o">+=</span> <span class="mi">1</span>
    
<div class="viewcode-block" id="Model.postprocess"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.postprocess">[docs]</a>    <span class="k">def</span> <span class="nf">postprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">inputfile</span><span class="p">,</span><span class="n">namelist</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="s2">&quot;postprocess.log&quot;</span><span class="p">,</span><span class="n">crashifbroken</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;    Produce NetCDF output from an input file, using a specified postprocessing namelist. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inputfile : str</span>
<span class="sd">            The raw output file to be processed</span>
<span class="sd">        namelist : str </span>
<span class="sd">            The burn7 namelist to use</span>
<span class="sd">        log : str, optional</span>
<span class="sd">            The log file to which burn7 should output standard output and errors</span>
<span class="sd">        crashifbroken : bool, optional </span>
<span class="sd">            True/False. If True, exoplasim will run .integritycheck() on the file.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            1 if successful, 0 if not</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stat</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;./burn7.x -n&lt;</span><span class="si">%s</span><span class="s2">&gt;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">.nc&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">namelist</span><span class="p">,</span><span class="n">log</span><span class="p">,</span><span class="n">inputfile</span><span class="p">,</span><span class="n">inputfile</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">stat</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NetCDF output written to </span><span class="si">%s</span><span class="s2">.nc; log written to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">inputfile</span><span class="p">,</span><span class="n">log</span><span class="p">))</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">crashifbroken</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">integritycheck</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.nc&quot;</span><span class="o">%</span><span class="n">inputfile</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;burn7 threw some errors; may want to check </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">log</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Error writing output to </span><span class="si">%s</span><span class="s2">.nc; &quot;</span><span class="o">%</span><span class="n">inputfile</span> <span class="o">+</span>
                                        <span class="s2">&quot;log written to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">log</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error writing output to </span><span class="si">%s</span><span class="s2">.nc; log written to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">inputfile</span><span class="p">,</span><span class="n">log</span><span class="p">))</span>
            <span class="k">return</span> <span class="mi">0</span></div>
        
<div class="viewcode-block" id="Model.integritycheck"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.integritycheck">[docs]</a>    <span class="k">def</span> <span class="nf">integritycheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ncfile</span><span class="p">):</span> <span class="c1">#MUST pass a NetCDF file that contains surface temperature</span>
        <span class="sd">&quot;&quot;&quot;    Check an output file to see it contains the expected variables and isn&#39;t full of NaNs.</span>
<span class="sd">            </span>
<span class="sd">        If the file does not exist, exoplasim will attempt to create it using the postprocessor.</span>
<span class="sd">        If the file does not have the expected variables or is full of trash, an exception will</span>
<span class="sd">        be raised. If the file is fine, this function returns a 1. If the file did not exist and</span>
<span class="sd">        cannot be created, this function will return a 0. </span>
<span class="sd">            </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ncfile : str </span>
<span class="sd">            The output file to check.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            0 or 1 depending on failure or success respectively</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="n">ioe</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">ncfile</span><span class="p">):</span> <span class="c1">#If the specified output file does not exist, create it</span>
            <span class="n">ioe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span><span class="s2">&quot;example.nl&quot;</span><span class="p">,</span><span class="n">crashifbroken</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ioe</span><span class="p">:</span>
            <span class="n">ncd</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="n">ncd</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;ts&quot;</span><span class="p">][:]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Output is missing surface temperature; check logs for errors&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Non-finite values found in surface temperature&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span></div>
                
<div class="viewcode-block" id="Model.finalize"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.finalize">[docs]</a>    <span class="k">def</span> <span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outputdir</span><span class="p">,</span><span class="n">allyears</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">keeprestarts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move outputs and optionally restarts to a specified output directory. </span>
<span class="sd">            </span>
<span class="sd">        If more than the final year of output is being kept, a folder will be created in the output directory using the model name. Otherwise, finalized files will be renamed using the model name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        outputdir : str</span>
<span class="sd">            Directory in which to put output.</span>
<span class="sd">        allyears : bool, optional</span>
<span class="sd">            True/False. If True, output from all years will be kept, in a directory in</span>
<span class="sd">            outputdir named with the model name. Otherwise, the most recent year will be</span>
<span class="sd">            kept in outputdir, using the model name. Default False.</span>
<span class="sd">        keeprestarts : bool, optional</span>
<span class="sd">            True/False: If True, restart files will be kept as well as output files.</span>
<span class="sd">            Default False.</span>
<span class="sd">        clean : bool, optional</span>
<span class="sd">            True/False. If True, the original working directory will be deleted after files</span>
<span class="sd">            are moved. Default True.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">outputdir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;/&quot;</span><span class="p">:</span>
            <span class="n">outputdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">outputdir</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">outputdir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mkdir </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">outputdir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">allyears</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">outputdir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mkdir </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2">/MOST*.nc </span><span class="si">%s</span><span class="s2">/&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">snapshots</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp -r </span><span class="si">%s</span><span class="s2">/snapshots </span><span class="si">%s</span><span class="s2">/snapshots&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s1">&#39;toggle&#39;</span><span class="p">]:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp -r </span><span class="si">%s</span><span class="s2">/highcadence </span><span class="si">%s</span><span class="s2">/highcadence&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">))</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2">/MOST*DIAG* </span><span class="si">%s</span><span class="s2">/&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">keeprestarts</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2">/MOST_REST* </span><span class="si">%s</span><span class="s2">/&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">))</span>
            <span class="c1">#else:</span>
            <span class="c1">#    restarts = sorted(glob.glob(&quot;%s/MOST_REST*&quot;%self.workdir))</span>
            <span class="c1">#    os.system(&quot;cp %s %s/%s_restart&quot;%(restarts[-1],</span>
            <span class="c1">#                                        self.modelname,self.modelname))</span>
            <span class="n">newworkdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/MOST*.nc&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">outputdir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">.nc&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">))</span>
            <span class="n">diags</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/MOST*DIAG*&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">.DIAG&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">diags</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">snapshots</span><span class="p">:</span>
                <span class="n">snps</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/snapshots/*.nc&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">_snapshot.nc&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">snps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]:</span>
                <span class="n">hcs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/highcadence/MOST*.nc&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">_highcadence.nc&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">hcs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">keeprestarts</span><span class="p">:</span>
                <span class="n">rsts</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/MOST_REST*&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">_restart&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">rsts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">clean</span><span class="p">:</span>
                <span class="n">newworkdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cleaned</span><span class="o">=</span><span class="kc">True</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2">/*.cfg </span><span class="si">%s</span><span class="s2">/&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">outputdir</span><span class="p">,</span><span class="n">outputdir</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">clean</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm -rf </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workdir</span> <span class="o">=</span> <span class="n">newworkdir</span></div>
                
    
<div class="viewcode-block" id="Model.get"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">year</span><span class="p">,</span><span class="n">snapshot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">highcadence</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an open NetCDF data object for the given year. Defaults is to return time-averaged output.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        year : int </span>
<span class="sd">            Integer year of output to return</span>
<span class="sd">        snapshot: bool, optional</span>
<span class="sd">            True/False. If True, return the snapshot version.</span>
<span class="sd">        highcadence: bool, optional</span>
<span class="sd">            True/False. If True, return the high-cadence version.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        netCDF4.Dataset</span>
<span class="sd">            An open netCDF4 data opject</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#Note: if the work directory has been cleaned out, only the final year will be returned.</span>
        <span class="k">if</span> <span class="n">snapshot</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">highcadence</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;snapshots/MOST_SNAP.</span><span class="si">%05d</span><span class="s2">.nc&quot;</span><span class="o">%</span><span class="n">year</span>
        <span class="k">elif</span> <span class="n">highcadence</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">snapshot</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;highcadence/MOST_HC.</span><span class="si">%05d</span><span class="s2">.nc&quot;</span><span class="o">%</span><span class="n">year</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;MOST.</span><span class="si">%05d</span><span class="s2">.nc&quot;</span><span class="o">%</span><span class="n">year</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">snapshot</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">highcadence</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_snapshot.nc&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span>
            <span class="k">elif</span> <span class="n">highcadence</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">snapshot</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_highcadence.nc&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.nc&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">name</span><span class="p">):</span>
            <span class="n">ncd</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">name</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ncd</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Output file </span><span class="si">%s</span><span class="s2"> not found.&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">name</span><span class="p">))</span></div>
    
<div class="viewcode-block" id="Model.inspect"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.inspect">[docs]</a>    <span class="k">def</span> <span class="nf">inspect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variable</span><span class="p">,</span><span class="n">year</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">ignoreNaNs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">snapshot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">highcadence</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">savg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">tavg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">layer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a given output variable from a given year, with optional averaging parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        variable : str</span>
<span class="sd">            The name of the variable to return.</span>
<span class="sd">        year : int, optional</span>
<span class="sd">            Which year of output to return. Year indexing follows Pythonic rules. If the model</span>
<span class="sd">            has been finalized, only the final year of output will be returned.</span>
<span class="sd">        ignoreNaNs : bool, optional</span>
<span class="sd">            True/False. If True, use NaN-tolerant numpy functions.</span>
<span class="sd">        snapshot : bool, optional</span>
<span class="sd">            True/False. If True, use snapshot output instead of time-averaged.</span>
<span class="sd">        highcadence : bool, optional</span>
<span class="sd">            True/False. If True, use high-cadednce output instead of time-averaged.</span>
<span class="sd">        savg : bool, optional</span>
<span class="sd">            True/False. If True, compute the spatial average. Default False</span>
<span class="sd">        tavg : bool, optional</span>
<span class="sd">            True/False. If True, compute the annual average. Default False</span>
<span class="sd">        layer : int, optional</span>
<span class="sd">            If specified and data has 3 spatial dimensions, extract the specified layer. If</span>
<span class="sd">            unspecified and data has 3 spatial dimensions, the vertical dimension will be</span>
<span class="sd">            preserved (even if spatial averages are being computed).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float or numpy.ndarray</span>
<span class="sd">            The requested data, averaged if that was requested.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#Note: if the work directory has been cleaned out, only the final year will be returned.</span>
        <span class="k">if</span> <span class="n">snapshot</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">highcadence</span><span class="p">:</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="s2">&quot;snapshots/MOST_SNAP&quot;</span>
        <span class="k">elif</span> <span class="n">highcadence</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">snapshot</span><span class="p">:</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="s2">&quot;highcadence/MOST_HC&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="s2">&quot;MOST&quot;</span>
        
        <span class="k">if</span> <span class="n">ignoreNaNs</span><span class="p">:</span>
            <span class="n">meanop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">meanop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span>
        
        <span class="k">if</span> <span class="n">year</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">nfiles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">pattern</span><span class="o">+</span><span class="s2">&quot;*.nc&quot;</span><span class="p">))</span>
            <span class="n">year</span> <span class="o">=</span> <span class="n">nfiles</span><span class="o">+</span><span class="n">year</span>
    
        <span class="n">ncd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="n">snapshot</span><span class="o">=</span><span class="n">snapshot</span><span class="p">,</span><span class="n">highcadence</span><span class="o">=</span><span class="n">highcadence</span><span class="p">)</span>
        
        <span class="n">var</span> <span class="o">=</span> <span class="n">ncd</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">variable</span><span class="p">][:]</span>
        
        <span class="k">if</span> <span class="n">variable</span><span class="o">!=</span><span class="s2">&quot;lat&quot;</span> <span class="ow">and</span> <span class="n">variable</span><span class="o">!=</span><span class="s2">&quot;lon&quot;</span> <span class="ow">and</span> <span class="n">variable</span><span class="o">!=</span><span class="s2">&quot;lev&quot;</span> <span class="ow">and</span> <span class="n">variable</span><span class="o">!=</span><span class="s2">&quot;time&quot;</span><span class="p">:</span>
            <span class="n">lon</span> <span class="o">=</span> <span class="n">ncd</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">][:]</span>
            <span class="n">lat</span> <span class="o">=</span> <span class="n">ncd</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">][:]</span>
            <span class="n">lev</span> <span class="o">=</span> <span class="n">ncd</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lev&#39;</span><span class="p">][:]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">savg</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">tavg</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">var</span>
            <span class="k">elif</span> <span class="n">tavg</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">savg</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">meanop</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">tavg</span> <span class="ow">and</span> <span class="n">savg</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span> <span class="c1">#3D spatial array, plus time</span>
                <span class="c1">#We&#39;re going to get a scalar; user has specified a level</span>
                    <span class="k">return</span> <span class="n">gcmt</span><span class="o">.</span><span class="n">spatialmath</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span><span class="n">ignoreNaNs</span><span class="o">=</span><span class="n">ignoreNaNs</span><span class="p">,</span><span class="n">lev</span><span class="o">=</span><span class="n">layer</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
                    <span class="c1">#We&#39;re going to get a 1D vertical profile where each layer is a spatial avg</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lev</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lev</span><span class="p">)):</span>
                        <span class="n">output</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcmt</span><span class="o">.</span><span class="n">spatialmath</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span>
                                                    <span class="n">ignoreNaNs</span><span class="o">=</span><span class="n">ignoreNaNs</span><span class="p">,</span><span class="n">lev</span><span class="o">=</span><span class="n">l</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">output</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span> <span class="c1">#2D spatial array, plus time</span>
                    <span class="k">return</span> <span class="n">gcmt</span><span class="o">.</span><span class="n">spatialmath</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span><span class="n">ignoreNaNs</span><span class="o">=</span><span class="n">ignoreNaNs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span> <span class="c1">#3D spatial array, plus time</span>
                <span class="c1">#We&#39;re going to get a 1D array; user has specified a level</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)):</span>
                        <span class="n">output</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcmt</span><span class="o">.</span><span class="n">spatialmath</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span><span class="n">ignoreNaNs</span><span class="o">=</span><span class="n">ignoreNaNs</span><span class="p">,</span>
                                                    <span class="n">lev</span><span class="o">=</span><span class="n">layer</span><span class="p">,</span><span class="n">time</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">output</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
                    <span class="c1">#We&#39;re going to get a 1D vertical profile plus time</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">lev</span><span class="p">)))</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lev</span><span class="p">)):</span>
                            <span class="n">output</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcmt</span><span class="o">.</span><span class="n">spatialmath</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span><span class="n">time</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                                                    <span class="n">ignoreNaNs</span><span class="o">=</span><span class="n">ignoreNaNs</span><span class="p">,</span><span class="n">lev</span><span class="o">=</span><span class="n">l</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">output</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span> <span class="c1">#2D spatial array, plus time</span>
                    <span class="c1">#We&#39;re going to get a 1D array</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)):</span>
                        <span class="n">output</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcmt</span><span class="o">.</span><span class="n">spatialmath</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span>
                                                    <span class="n">time</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">ignoreNaNs</span><span class="o">=</span><span class="n">ignoreNaNs</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">output</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">var</span></div>
                
    
    <span class="k">def</span> <span class="nf">_crash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Crash and burn. But gracefully.&quot;&quot;&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mv </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">_crashed&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">crashdir</span><span class="p">))</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ExoPlaSim has crashed or begun producing garbage. All working files have been moved to </span><span class="si">%s</span><span class="s2">_crashed/&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="p">))</span>
        
<div class="viewcode-block" id="Model.configure"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.configure">[docs]</a>    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">noutput</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">flux</span><span class="o">=</span><span class="mf">1367.0</span><span class="p">,</span><span class="n">startemp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">starspec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">pH2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">pHe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">pN2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">pO2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">pCO2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">pAr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">pNe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">pKr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">pH2O</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">gascon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">pressure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">pressurebroaden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">vtype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">rotationperiod</span><span class="o">=</span><span class="mf">24.0</span><span class="p">,</span><span class="n">synchronous</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">substellarlon</span><span class="o">=</span><span class="mf">180.0</span><span class="p">,</span>
            <span class="n">year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">glaciers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;toggle&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span><span class="s2">&quot;mindepth&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span><span class="s2">&quot;initialh&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">1.0</span><span class="p">},</span>
            <span class="n">restartfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">gravity</span><span class="o">=</span><span class="mf">9.80665</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">eccentricity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">obliquity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">lonvernaleq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fixedorbit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">orography</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">seaice</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">co2weathering</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">evolveco2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">physicsfilter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">filterkappa</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span><span class="n">filterpower</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">filterLHN0</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span><span class="n">diffusionwaven</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">qdiffusion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">tdiffusion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">zdiffusion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ddiffusion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">diffusionpower</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">erosionsupplylimit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">outgassing</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span><span class="n">snowicealbedo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">twobandalbedo</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">maxsnow</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">soilalbedo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">oceanalbedo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">oceanzenith</span><span class="o">=</span><span class="s2">&quot;ECHAM-3&quot;</span><span class="p">,</span><span class="n">wetsoil</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">soilwatercap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">aquaplanet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">desertplanet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">soilsaturation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">drycore</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">ozone</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">cpsoil</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">soildepth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">mldepth</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span>
            <span class="n">writefrequency</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">modeltop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">stratosphere</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">tropopause</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="mf">45.0</span><span class="p">,</span><span class="n">runscript</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">columnmode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">highcadence</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;toggle&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;start&quot;</span><span class="p">:</span><span class="mi">320</span><span class="p">,</span><span class="s2">&quot;end&quot;</span><span class="p">:</span><span class="mi">576</span><span class="p">,</span><span class="s2">&quot;interval&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">},</span>
            <span class="n">snapshots</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">resources</span><span class="o">=</span><span class="p">[],</span><span class="n">landmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">stormclim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nstorms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">stormcapture</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;VITHRESH&quot;</span><span class="p">:</span><span class="mf">0.145</span><span class="p">,</span><span class="s2">&quot;GPITHRESH&quot;</span><span class="p">:</span><span class="mf">0.37</span><span class="p">,</span><span class="s2">&quot;VMXTHRESH&quot;</span><span class="p">:</span><span class="mf">33.0</span><span class="p">,</span>
                            <span class="s2">&quot;LAVTHRESH&quot;</span><span class="p">:</span><span class="mf">1.2e-5</span><span class="p">,</span><span class="s2">&quot;VRMTHRESH&quot;</span><span class="p">:</span><span class="mf">0.577</span><span class="p">,</span><span class="s2">&quot;MINSURFTEMP&quot;</span><span class="p">:</span><span class="mf">298.15</span><span class="p">,</span>
                            <span class="s2">&quot;MAXSURFTEMP&quot;</span><span class="p">:</span><span class="mf">373.15</span><span class="p">,</span><span class="s2">&quot;WINDTHRESH&quot;</span><span class="p">:</span><span class="mf">33.0</span><span class="p">,</span><span class="s2">&quot;SWINDTHRESH&quot;</span><span class="p">:</span><span class="mf">20.5</span><span class="p">,</span>
                            <span class="s2">&quot;SIZETHRESH&quot;</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span><span class="s2">&quot;ENDTHRESH&quot;</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="s2">&quot;MINSTORMLEN&quot;</span><span class="p">:</span><span class="mi">256</span><span class="p">,</span>
                            <span class="s2">&quot;MAXSTORMLEN&quot;</span><span class="p">:</span><span class="mi">1024</span><span class="p">,</span><span class="s2">&quot;NKTRIGGER&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;toggle&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span>
            <span class="n">topomap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="mf">5.0e-4</span><span class="p">,</span><span class="n">otherargs</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Configure the model&#39;s namelists and boundary conditions.</span>
<span class="sd">        </span>
<span class="sd">        The defaults here are appropriate for an Earth model.</span>
<span class="sd">                </span>
<span class="sd">    **Model Operation**</span>
<span class="sd">    </span>
<span class="sd">            noutput : bool, optional </span>
<span class="sd">               True/False. Whether or not model output should be written.</span>
<span class="sd">               restartfile: Path to a restart file to use for initial conditions. Can be None.</span>
<span class="sd">            writefrequency : int, optional </span>
<span class="sd">               How many times per day ExoPlaSim should write output. Ignored by</span>
<span class="sd">               default--default is to write time-averaged output once every 5 days.</span>
<span class="sd">            timestep : float, optional </span>
<span class="sd">               Model timestep. Defaults to 45 minutes.</span>
<span class="sd">            runscript : function , optional</span>
<span class="sd">               A Python function that accepts a Model object as its first argument. This</span>
<span class="sd">               is the routine that will be run when you issue the Model.run() command.</span>
<span class="sd">               Any keyword arguments passed to run() will be forwarded to the specified</span>
<span class="sd">               function. If not set, the default internal routine will be used.</span>
<span class="sd">            snapshots : int, optional </span>
<span class="sd">               How many timesteps should elapse between snapshot outputs. If not set,</span>
<span class="sd">               no snapshots will be written.</span>
<span class="sd">            highcadence : dict, optional </span>
<span class="sd">               A dictionary containing the following arguments:</span>
<span class="sd">               </span>
<span class="sd">                ``&#39;toggle&#39;`` : {0,1}</span>
<span class="sd">                    Whether or not high-cadence output should be written (1=yes).</span>
<span class="sd">                ``&#39;start&#39;`` : int</span>
<span class="sd">                    Timestep at which high-cadence output should begin.</span>
<span class="sd">                ``&#39;end&#39;`` : int</span>
<span class="sd">                    Timestep at which high-cadence output should end.</span>
<span class="sd">                ``&#39;interval&#39;`` : int</span>
<span class="sd">                    How many timesteps should elapse between high-cadence outputs.</span>
<span class="sd">            threshold : float, optional </span>
<span class="sd">               Energy balance threshold model should run to, if using runtobalance().</span>
<span class="sd">               Default is &lt;0.05 W/m^2/yr average drift in TOA and surface energy balance</span>
<span class="sd">               over 45-year timescales.</span>
<span class="sd">            resources : list, optional </span>
<span class="sd">               A list of paths to any additional files that should be available in the</span>
<span class="sd">               run directory.</span>
<span class="sd">            otherargs : dict, optional </span>
<span class="sd">               Any namelist parameters not included by default in the configuration options.</span>
<span class="sd">               These should be passed as a dictionary, with &quot;PARAMETER@namelist&quot; as the</span>
<span class="sd">               form of the dictionary key, and the parameter value passed as a string.</span>
<span class="sd">               e.g. ``otherargs={&quot;N_RUN_MONTHS@plasim_namelist&quot;:&#39;4&#39;,&quot;NGUI@plasim_namelist:&#39;1&#39;}``</span>
<span class="sd">              </span>
<span class="sd">    **Model Dynamics**</span>
<span class="sd">    </span>
<span class="sd">            columnmode : {None,&quot;-&quot;,&quot;clear&quot;,&quot;static&quot;,&quot;static|clear&quot;,&quot;clear|static&quot;}, optional </span>
<span class="sd">               The inclusion of &#39;static&#39; will disable horizontal advection, forcing ExoPlaSim</span>
<span class="sd">               into a column-only mode of operation. The inclusion of &#39;clear&#39; will disable</span>
<span class="sd">               the radiative effects of clouds.</span>
<span class="sd">            drycore : bool, optional </span>
<span class="sd">               True/False. If True, evaporation is turned off, and a dry atmosphere will</span>
<span class="sd">               be used.</span>
<span class="sd">            physicsfilter : str, optional</span>
<span class="sd">               If not an empty string, specifies the physics filter(s) to be used. Filters</span>
<span class="sd">               can be used during the transform from gridpoint to spectral (``&quot;gp&quot;``), and/or</span>
<span class="sd">               during the transform from spectral to gridpoint (``&quot;sp&quot;``). Filter types are</span>
<span class="sd">               &quot;none&quot;, &quot;cesaro&quot;, &quot;exp&quot;, or &quot;lh&quot; (see the Notes for more details).</span>
<span class="sd">               Combinations of filter types and times should be combined with a ``|``,</span>
<span class="sd">               e.g. ``physicsfilter=&quot;gp|exp|sp&quot;`` or ``physicsfilter=&quot;gp|cesaro&quot;``.</span>
<span class="sd">            filterkappa : float, optional </span>
<span class="sd">               A constant to be used with the exponential filter. Default is 8.0.</span>
<span class="sd">            filterpower : int, optional </span>
<span class="sd">               A constant integer to be used with the exponential filter. Default is 8.</span>
<span class="sd">            filterLHN0 : float, optional </span>
<span class="sd">               The constant used in the denominator of the Lander-Hoskins Filter. Default</span>
<span class="sd">               is 15; typically chosen so f(N)=0.1.</span>
<span class="sd">            diffusionwaven : int, optional </span>
<span class="sd">               The critical wavenumber beyond which hyperdiffusion is applied. Default</span>
<span class="sd">               is 15 for T21.</span>
<span class="sd">            qdiffusion : float, optional </span>
<span class="sd">               Timescale for humidity hyperdiffusion in days. Default for T21 is 0.1.</span>
<span class="sd">            tdiffusion : float, optional</span>
<span class="sd">               Timescale for temperature hyperdiffusion in days. Default for T21 is 5.6.</span>
<span class="sd">            zdiffusion : float, optional</span>
<span class="sd">               Timescale for vorticity hyperdiffusion in days. Default for T21 is 1.1.</span>
<span class="sd">            ddiffusion : float, optional</span>
<span class="sd">               Timescale for divergence hyperdiffusion in days.. Default for T21 is 0.2.</span>
<span class="sd">            diffusionpower : int, optional</span>
<span class="sd">               integer exponent used in hyperdiffusion. Default is 2 for T21.</span>
<span class="sd">                </span>
<span class="sd">    **Radiation**</span>
<span class="sd">    </span>
<span class="sd">            flux : float, optional</span>
<span class="sd">               Incident stellar flux in W/m^2. Default 1367 for Earth.</span>
<span class="sd">            startemp : float, optional</span>
<span class="sd">               Effective blackbody temperature for the star. Not used if not set.</span>
<span class="sd">            starspec : str, optional</span>
<span class="sd">               Spectral file for the stellar spectrum. Should have two columns and 965 rows,</span>
<span class="sd">               with wavelength in the first column and radiance or intensity in the second.</span>
<span class="sd">               A similarly-named file with the &quot;_hr.dat&quot; suffix must also exist and have </span>
<span class="sd">               2048 wavelengths.</span>
<span class="sd">            twobandalbedo : bool, optional</span>
<span class="sd">               True/False. If True, separate albedos will be calculated for each of the</span>
<span class="sd">               two shortwave bands. If False (default), a single broadband albedo will be</span>
<span class="sd">               computed and used for both.</span>
<span class="sd">            synchronous : bool, optional</span>
<span class="sd">               True/False. If True, the Sun is fixed to one longitude in the sky.</span>
<span class="sd">            substellarlon : float, optional</span>
<span class="sd">               The longitude of the substellar point, if synchronous==True. Default 180</span>
<span class="sd">            pressurebroaden : bool, optional </span>
<span class="sd">               True/False. If False, pressure-broadening of absorbers no longer depends</span>
<span class="sd">               on surface pressure. Default is True</span>
<span class="sd">            ozone : bool, optional</span>
<span class="sd">               True/False. Whether or not forcing from stratospheric ozone should be included.</span>
<span class="sd">            snowicealbedo : float, optional</span>
<span class="sd">               A uniform albedo to use for all snow and ice.</span>
<span class="sd">            soilalbedo : float, optional</span>
<span class="sd">               A uniform albedo to use for all land.</span>
<span class="sd">            wetsoil : bool, optional</span>
<span class="sd">               True/False. If True, land albedo depends on soil moisture (wet=darker).</span>
<span class="sd">            oceanalbedo : float, optional</span>
<span class="sd">               A uniform albedo to use for the ocean.</span>
<span class="sd">            oceanzenith : {&quot;ECHAM-3&quot;,&quot;ECHAM-6&quot;,&quot;Lambertian}, optional</span>
<span class="sd">               The zenith-angle dependence to use for blue-light reflectance from the ocean.</span>
<span class="sd">               Can be ``&#39;Lambertian&#39;``/``&#39;uniform&#39;``, ``&#39;ECHAM-3&#39;``/``&#39;plasim&#39;``/``&#39;default&#39;``, or ``&#39;ECHAM-6&#39;``.</span>
<span class="sd">               The default is ``&#39;ECHAM-3&#39;`` (synonymous with ``&#39;plasim&#39;`` and ``&#39;default&#39;``), which is</span>
<span class="sd">               the dependence used in the ECHAM-3 model.</span>
<span class="sd">                                 </span>
<span class="sd">    **Orbital Parameters**</span>
<span class="sd">    </span>
<span class="sd">            year : float, optional</span>
<span class="sd">              Number of 24-hour days in a sidereal year. Not necessary if eccentricity and </span>
<span class="sd">              obliquity are zero. Defaults if not set to ~365.25 days</span>
<span class="sd">            rotationperiod : float, optional</span>
<span class="sd">              Planetary rotation period, in days. Default is 1.0.</span>
<span class="sd">            eccentricity : float, optional</span>
<span class="sd">              Orbital eccentricity. If not set, defaults to Earth&#39;s (0.016715)</span>
<span class="sd">            obliquity : float, optional</span>
<span class="sd">              Axial tilt, in degrees. If not set, defaults to Earth&#39;s obliquity (23.441).</span>
<span class="sd">            lonvernaleq : float, optional</span>
<span class="sd">              Longitude of periapse, measured from vernal equinox, in degrees. If </span>
<span class="sd">              not set, defaults to Earth&#39;s (102.7).</span>
<span class="sd">            fixedorbit : bool, optional</span>
<span class="sd">              True/False. If True, orbital parameters do not vary over time. If False,</span>
<span class="sd">              variations such as Milankovich cycles will be computed by PlaSim.</span>
<span class="sd">                </span>
<span class="sd">    **Planet Parameters**</span>
<span class="sd">    </span>
<span class="sd">            gravity : float, optional </span>
<span class="sd">              Surface gravity, in m/s^2. Defaults to 9.80665 m/s^2.</span>
<span class="sd">            radius : float, optional </span>
<span class="sd">              Planet radius in Earth radii. Default is 1.0.</span>
<span class="sd">            orography : float, optional </span>
<span class="sd">              If set, a scaling factor for topographic relief. If ``orography=0.0``, topography</span>
<span class="sd">              will be zeroed-out.</span>
<span class="sd">            aquaplanet : bool, optional </span>
<span class="sd">              True/False. If True, the surface will be entirely ocean-covered.</span>
<span class="sd">            desertplanet : bool, optional </span>
<span class="sd">              True/False. If True, the surface will be entirely land-covered.</span>
<span class="sd">            seaice : bool, optional </span>
<span class="sd">              True/False. If False, disables radiative effects of sea ice (although sea ice </span>
<span class="sd">              itself is still computed).</span>
<span class="sd">            landmap : str, optional </span>
<span class="sd">              Path to a ``.sra`` file containing a land mask for the chosen resolution.</span>
<span class="sd">            topomap : str, optional </span>
<span class="sd">              Path to a ``.sra`` file containing geopotential height map. Must include landmap.</span>
<span class="sd">                </span>
<span class="sd">    **Atmosphere**</span>
<span class="sd">    </span>
<span class="sd">            gascon : float, optional</span>
<span class="sd">               Effective gas constant. Defaults to 287.0 (Earth), or the gas constant</span>
<span class="sd">               corresponding to the composition specified by partial pressures.</span>
<span class="sd">            vtype : {0,1,2,3,4,5}, optional</span>
<span class="sd">               Type of vertical discretization. Can be:</span>
<span class="sd">               0   Pseudolinear scaling with pressure that maintains resolution near the ground.</span>
<span class="sd">               1   Linear scaling with pressure.</span>
<span class="sd">               2   Logarithmic scaling with pressure (resolves high altitudes)</span>
<span class="sd">               3   Pseudologarithmic scaling with pressure that preserves resolution near the ground.</span>
<span class="sd">               4   Pseudolinear scaling with pressure, pinned to a specified top pressure.</span>
<span class="sd">               5   If &gt;10 layers, bottom 10 as if ``vtype=4``, and upper layers as if ``vtype=2``.</span>
<span class="sd">            modeltop : float, optional</span>
<span class="sd">               Pressure of the top layer</span>
<span class="sd">            tropopause : float, optional</span>
<span class="sd">               If stratosphere is being included, pressure of the 10th layer (where scheme</span>
<span class="sd">               switches from linear to logarithmic).</span>
<span class="sd">            stratosphere : bool, optional</span>
<span class="sd">               True/False. If True, vtype=5 is used, and model is discretized to include</span>
<span class="sd">               a stratosphere.</span>
<span class="sd">            pressure: float, optional</span>
<span class="sd">                  Surface pressure in bars, if not specified through partial pressures.</span>
<span class="sd">                </span>
<span class="sd">    **Gas Partial Pressures**</span>
<span class="sd">        </span>
<span class="sd">    Partial pressures of individual gases can be specified. If pressure and gascon are not explicitly set, these will determine surface pressure, mean molecular weight, and effective gas constant. Note however that Rayleigh scattering assumes an Earth-like composition, and the only absorbers explicitly included in the radiation scheme are CO2 and H2O.</span>
<span class="sd">            </span>
<span class="sd">            pH2 : float, optional   </span>
<span class="sd">                H2 partial pressure in bars.</span>
<span class="sd">            pHe : float, optional   </span>
<span class="sd">                He partial pressure in bars.</span>
<span class="sd">            pN2 : float, optional  </span>
<span class="sd">                N2 partial pressure in bars.</span>
<span class="sd">            pO2 : float, optional  </span>
<span class="sd">                O2 partial pressure in bars.</span>
<span class="sd">            pH2 : float, optional  </span>
<span class="sd">                H2 partial pressure in bars.</span>
<span class="sd">            pAr : float, optional  </span>
<span class="sd">                Ar partial pressure in bars.</span>
<span class="sd">            pNe : float, optional  </span>
<span class="sd">                Ne partial pressure in bars.</span>
<span class="sd">            pKr : float, optional  </span>
<span class="sd">                Kr partial pressure in bars.</span>
<span class="sd">            pCO2 : float, optional  </span>
<span class="sd">                CO2 partial pressure in bars. This gets translated into a ppmv concentration, so if you want to specify/vary CO2 but don&#39;t need the other gases, specifying pCO2, pressure, and gascon will do the trick. In most use cases, however, just specifying pN2 and pCO2 will give good enough behavior.</span>
<span class="sd">            pH2O : float, optional  </span>
<span class="sd">                H2O partial pressure in bars. This is only useful in setting the gas constant and surface pressure; it will have no effect on actual moist processes.</span>
<span class="sd">                    </span>
<span class="sd">    **Surface Parameters**</span>
<span class="sd">    </span>
<span class="sd">        mldepth : float, optional</span>
<span class="sd">           Depth of the mixed-layer ocean. Default is 50 meters.</span>
<span class="sd">        soildepth : float, optional</span>
<span class="sd">           Scaling factor for the depth of soil layers (default total of 12.4 meters)</span>
<span class="sd">        cpsoil : float, optional</span>
<span class="sd">           Heat capacity of the soil, in J/m^3/K. Default is 2.4*10^6.</span>
<span class="sd">        soilwatercap : float, optional</span>
<span class="sd">           Water capacity of the soil, in meters. Defaults to 0.5 meters</span>
<span class="sd">        soilsaturation : float, optional</span>
<span class="sd">           Initial fractional saturation of the soil. Default is 0.0 (dry).</span>
<span class="sd">        maxsnow : float, optional</span>
<span class="sd">           Maximum snow depth (Default is 5 meters; set to -1 to have no limit).</span>
<span class="sd">                </span>
<span class="sd">    **Additional Physics**</span>
<span class="sd">        </span>
<span class="sd">        Carbon-Silicate Weathering</span>
<span class="sd">           co2weathering : bool, optional</span>
<span class="sd">              True/False. Toggles whether or not carbon-silicate weathering should be</span>
<span class="sd">              computed. Default is False.   </span>
<span class="sd">           evolveco2 : bool, optional</span>
<span class="sd">              True/False. If co2weathering==True, toggles whether or not the CO2 partial</span>
<span class="sd">              pressure should be updated every year. Usually the change in pCO2 will be </span>
<span class="sd">              extremely small, so this is not necessary, and weathering experiments try</span>
<span class="sd">              to estimate the average weathering rate for a given climate in order to </span>
<span class="sd">              interpolate timescales between climates, rather than modelling changes in CO2</span>
<span class="sd">              over time directly.</span>
<span class="sd">           outgassing : float, optional </span>
<span class="sd">              The assumed CO2 outgassing rate in units of Earth outgassing. Default is 1.0.</span>
<span class="sd">           erosionsupplylimit : float, optional</span>
<span class="sd">              If set, the maximum CO2 weathering rate per year permitted by</span>
<span class="sd">              erosion, in ubars/year. This is not simply a hard cutoff, but follows</span>
<span class="sd">              Foley 2015 so high weathering below the cutoff is also reduced.</span>
<span class="sd">        </span>
<span class="sd">    See [1]_ for details on the implementation of supply-limited weathering.</span>
<span class="sd">        </span>
<span class="sd">        Glaciology</span>
<span class="sd">           glaciers : dict, optional </span>
<span class="sd">              A dictionary containing the following arguments:</span>
<span class="sd">              toggle : bool</span>
<span class="sd">                   True/False. Whether or not glaciers should be allowed to grow or shrink in thickness, or be formed from persistent snow on land.</span>
<span class="sd">              mindepth : float </span>
<span class="sd">                   The minimum snow depth in meters of liquid water equivalent that must persist year-round before the grid cell is considered glaciated. Default is 2 meters.</span>
<span class="sd">              initialh : float </span>
<span class="sd">                   If &gt;=0, covers the land surface with ice sheets of a height given in meterss. If -1, no initial ice sheets are assumed.</span>
<span class="sd">           </span>
<span class="sd">        Storm Climatology</span>
<span class="sd">           stormclim : bool, optional </span>
<span class="sd">              True/False. Toggles whether or not storm climatology (convective available</span>
<span class="sd">              potential energy, maximum potential intensity, ventilation index, etc)</span>
<span class="sd">              should be computed. If True, output fields related to storm climatology </span>
<span class="sd">              will be added to standard output files. Enabling this mode currently roughly</span>
<span class="sd">              doubles the computational cost of the model. This may improve in future </span>
<span class="sd">              updates. Refer to Paradise, et al 2021 for implementation description. </span>
<span class="sd">              </span>
<span class="sd">           stormcapture : dict, optional</span>
<span class="sd">              A dictionary containing arguments controlling when high-cadence output</span>
<span class="sd">              is triggered by storm activity. This dictionary must contain &#39;toggle&#39;, which</span>
<span class="sd">              can be either 1 or 0 (yes or no). It may also contain any namelist</span>
<span class="sd">              parameters accepted by hurricanemod.f90, including the following:</span>
<span class="sd">              </span>
<span class="sd">              toggle : {0,1}</span>
<span class="sd">                   Whether (1) or not (0) to write high-cadence output when storms occur</span>
<span class="sd">              NKTRIGGER : {0,1}, optional </span>
<span class="sd">                   (0/1=no/yes). Whether or not to use the Komacek, et al 2020 conditions for hurricane cyclogenesis as the output trigger. Default is no.</span>
<span class="sd">              VITHRESH : float, optional</span>
<span class="sd">                   (nktrigger) Ventilation index threshold for nktrigger output. Default 0.145</span>
<span class="sd">              VMXTHRESH : float, optional </span>
<span class="sd">                   (nktrigger) Max potential intensity threshold for nktrigger output.Default 33 m/s</span>
<span class="sd">              LAVTHRESH : float, optional </span>
<span class="sd">                   (nktrigger) Lower-atmosphere vorticity threshold for nktrigger output. Default 1.2*10^-5 s^-1</span>
<span class="sd">              VRMTHRESH : float, optional </span>
<span class="sd">                   (unused) Ventilation-reduced maximum intensity threshold. Default 0.577</span>
<span class="sd">              GPITHRESH : float, optional  </span>
<span class="sd">                   (default) Genesis Potential Index threshold. Default 0.37.</span>
<span class="sd">              MINSURFTEMP : float, optional  </span>
<span class="sd">                   (default) Min. surface temperature for storm activity. Default 25C</span>
<span class="sd">              MAXSURFTEMP : float, optional  </span>
<span class="sd">                   (default) Max. surface temperature for storm activity. Default 100C</span>
<span class="sd">              WINDTHRESH : float, optional   </span>
<span class="sd">                   (default) Lower-atmosphere maximum wind threshold for storm activity.  Default 33 m/s</span>
<span class="sd">              SWINDTHRESH : float, optional  </span>
<span class="sd">                   (default) Minimum surface windspeed for storm activity. Default 20.5 m/s</span>
<span class="sd">              SIZETHRESH : float, optional  </span>
<span class="sd">                   (default) Minimum number of cells that must trigger to start outputDefault 30</span>
<span class="sd">              ENDTHRESH : float, optional  </span>
<span class="sd">                   (default) Minimum number of cells at which point storm output ends.Default 16</span>
<span class="sd">              MINSTORMLEN : float, optional  </span>
<span class="sd">                   (default) Minimum number of timesteps to write output. Default 256</span>
<span class="sd">              MAXSTORMLEN : float, optional  </span>
<span class="sd">                   (default) Maximum number of timesteps to write output. Default 1024</span>
<span class="sd">           </span>
<span class="sd">    Note that actual number of writes will be stormlen/interval, as set in highcadence. This interval defaults to 4, so 64 writes minimum, 256 max. For more details on the storm climatology factors considered here, see [5]_.</span>
<span class="sd">        </span>
<span class="sd">Notes</span>
<span class="sd">-----</span>
<span class="sd">        In some cases, it may be necessary to include physics filters. This typically becomes </span>
<span class="sd">        necessary when sharp features are projected on the model&#39;s smallest spectral modes, causing</span>
<span class="sd">        Gibbs &quot;ripples&quot;. Earth-like models typically do not require filtering, but tidally-locked</span>
<span class="sd">        models do. Filtering may be beneficial for Earth-like models at very high resolutions as well,</span>
<span class="sd">        or if there is sharp topography. </span>
<span class="sd">        </span>
<span class="sd">        Three filter functional forms are included in ExoPlaSim: Cesaro, exponential, and Lander-Hoskins. Their functional forms are given below, where `n` is the wavenumber, and `N` is the</span>
<span class="sd">        truncation wavenumber (e.g. 21 for T21):</span>
<span class="sd">        </span>
<span class="sd">        Cesaro: :math:`f(n)=1-\\frac{n}{N+1}` [2]_</span>
<span class="sd">        </span>
<span class="sd">        Exponential: :math:`f(n)=\exp\left[-\kappa\left(\\frac{n}{N}\\right)^\gamma\\right]` [3]_</span>
<span class="sd">        </span>
<span class="sd">        Lander-Hoskins: :math:`f(n)=\exp\left[-\left(\\frac{n(n+1)}{n_0(n_0+1}\\right)^2\\right]` [3]_ [4]_</span>
<span class="sd">        </span>
<span class="sd">        :math:`\kappa` is exposed to the user through ``filterkappa``, </span>
<span class="sd">        :math:`\gamma` is exposed through ``filterpower``, and :math:`n_0` is</span>
<span class="sd">        exposed through ``filterLHN0``.</span>
<span class="sd">        </span>
<span class="sd">        Physics filters can be applied at two different points; either at the transform from gridpoint</span>
<span class="sd">        to spectral, or the reverse. We find that in most cases, the ideal usage is to use both. </span>
<span class="sd">        Generally, a filter at the gridpoint-&gt;spectral transform is good for dealing with oscillations</span>
<span class="sd">        caused by sharp jumps and small features in the gridpoint tendencies. Conversely, a filter</span>
<span class="sd">        at the spectral-&gt;gridpoint transform is good for dealing with oscillations that come from</span>
<span class="sd">        small-scale features in the spectral fields causing small-scale features to appear in the</span>
<span class="sd">        gridpoint tendencies [3]_. Since we deal with climate systems where everything is coupled, </span>
<span class="sd">        any oscillations not removed by one filter will be amplified through physical feedbacks if not </span>
<span class="sd">        suppressed by the other filter.</span>
<span class="sd">        </span>
<span class="sd">See Also</span>
<span class="sd">--------</span>
<span class="sd">    modify : Change model configuration after it has been initialized</span>
<span class="sd">        </span>
<span class="sd">References</span>
<span class="sd">----------</span>
<span class="sd">        .. [1] Foley, B. J. (2015). The Role of Plate Tectonic-Climate Coupling and Exposed Land Area in the Development of Habitable Climates on Rocky Planets. The Astrophysical Journal, 812(1), 36. https://doi.org/10.1088/0004-637X/812/1/36</span>
<span class="sd">        </span>
<span class="sd">        .. [2] Navarra, A., Stern, W. F., &amp; Miyakoda, K. (1994). Reduction of the Gibbs Oscillation in Spectral Model Simulations. Journal of Climate, 7(8), 11691183. https://doi.org/10.1175/1520-0442(1994)007&lt;1169:ROTGOI&gt;2.0.CO;2</span>
<span class="sd">        </span>
<span class="sd">        .. [3] Lander, J., &amp; Hoskins, B. J. (1997). Believable Scales and Parameterizations in a Spectral Transform Model. Monthly Weather Review, 125(2), 292303. https://doi.org/10.1175/1520-0493(1997)125&lt;0292:BSAPIA&gt;2.0.CO;2</span>
<span class="sd">        </span>
<span class="sd">        .. [4] Scinocca, J. F., McFarlane, N. A., Lazare, M., Li, J., &amp; Plummer, D. (2008). Technical Note: The CCCma third generation AGCM and its extension into the middle atmosphere. Atmospheric Chemistry and Physics, 8(23), 70557074. https://doi.org/10.5194/acp-8-7055-2008</span>
<span class="sd">        </span>
<span class="sd">        .. [5] Komacek, T. D., Chavas, D. R., &amp; Abbot, D. S. (2020). Hurricane Genesis is Favorable on Terrestrial Exoplanets Orbiting Late-type M Dwarf Stars. The Astrophysical Journal, 898(2), 115. https://doi.org/10.3847/1538-4357/aba0b9</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NOUTPUT&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">noutput</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noutput</span> <span class="o">=</span> <span class="n">noutput</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;GSOL0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">flux</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">flux</span>
        <span class="k">if</span> <span class="n">startemp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTARTEMP&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;STARBBTEMP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">startemp</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startemp</span> <span class="o">=</span> <span class="n">startemp</span>
        <span class="k">if</span> <span class="n">starspec</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">starspec</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span><span class="o">==</span><span class="s2">&quot;.dat&quot;</span><span class="p">:</span>
                <span class="n">starspec</span><span class="o">=</span><span class="n">starspec</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTARFILE&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;STARFILE&quot;</span><span class="p">,</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="o">%</span><span class="n">starspec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;STARFILEHR&quot;</span><span class="p">,</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">_hr.dat&#39;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">starspec</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">starspec</span> <span class="o">=</span> <span class="n">starspec</span>
        
        <span class="k">if</span> <span class="n">pH2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pH2&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pH2</span>
        <span class="k">if</span> <span class="n">pHe</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pHe&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pHe</span>
        <span class="k">if</span> <span class="n">pN2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pN2&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pN2</span>
        <span class="k">if</span> <span class="n">pO2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pO2&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pO2</span>
        <span class="k">if</span> <span class="n">pCO2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pCO2&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pCO2</span>
        <span class="k">if</span> <span class="n">pAr</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pAr&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pAr</span>
        <span class="k">if</span> <span class="n">pNe</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pNe&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pNe</span>
        <span class="k">if</span> <span class="n">pKr</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pKr&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pKr</span>
        <span class="k">if</span> <span class="n">pH2O</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pH2O&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pH2O</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pressure</span><span class="p">:</span>
                <span class="c1">#self.pgases=gases_default</span>
                <span class="c1">#self.pressure=0.0</span>
                <span class="c1">#for gas in self.pgases:</span>
                    <span class="c1">#self.pressure+=self.pgases[gas] #in bars</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span> <span class="o">=</span> <span class="mf">1.011</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span> <span class="o">=</span> <span class="n">pressure</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span>
        
        <span class="n">gasesvx</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">:</span>
            <span class="n">gasesvx</span><span class="p">[</span><span class="n">gas</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mmw</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">gasesvx</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mmw</span> <span class="o">+=</span> <span class="n">gasesvx</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span><span class="o">*</span><span class="n">smws</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="o">+</span><span class="n">gas</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mmw</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mmw</span> <span class="o">=</span> <span class="mf">28.970253</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gascon</span> <span class="o">=</span> <span class="mf">8314.46261815324</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mmw</span>
        
        <span class="k">if</span> <span class="n">gascon</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gascon</span><span class="o">=</span><span class="n">gascon</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mmw</span> <span class="o">=</span> <span class="mf">8314.46261815324</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">gascon</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Molecular Weight set to </span><span class="si">%1.4f</span><span class="s1"> g/mol&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">mmw</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">pressure</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pressure</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="p">:</span>  <span class="c1">#User has specified a different pressure than sum of gas pressures</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span> <span class="o">=</span> <span class="n">pressure</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">CO2ppmv</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="s1">&#39;pCO2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CO2ppmv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s1">&#39;pCO2&#39;</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span> <span class="o">*</span> <span class="mf">1.0e6</span> <span class="c1">#ppmv</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;CO2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CO2ppmv</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;PSURF&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="o">*</span><span class="mf">1.0e5</span><span class="p">))</span> <span class="c1">#Pa</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;GASCON&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gascon</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NPBROADEN&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">pressurebroaden</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pressurebroaden</span><span class="o">=</span><span class="n">pressurebroaden</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NEQSIG&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">vtype</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtype</span><span class="o">=</span><span class="n">vtype</span>
        <span class="k">if</span> <span class="n">year</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;N_DAYS_PER_YEAR&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;SIDEREAL_YEAR&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="o">*</span><span class="mf">86400.0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sidyear</span><span class="o">=</span><span class="n">year</span>
        <span class="k">if</span> <span class="n">rotationperiod</span><span class="o">!=</span><span class="mf">1.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ROTSPD&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">rotationperiod</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;N_DAYS_PER_YEAR&quot;</span><span class="p">,</span>
                                <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">360.0</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">rotationperiod</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="o">+</span><span class="mf">0.5</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">12</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotationperiod</span><span class="o">=</span><span class="n">rotationperiod</span>
        <span class="k">if</span> <span class="n">synchronous</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFIXED&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;FIXEDLON&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">substellarlon</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">synchronous</span><span class="o">=</span><span class="n">synchronous</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substellarlon</span><span class="o">=</span><span class="n">substellarlon</span>
        
        <span class="k">if</span> <span class="n">restartfile</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">/plasim_restart&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">restartfile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/plasim_restart&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restartfile</span><span class="o">=</span><span class="n">restartfile</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;GA&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">gravity</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_postnamelist</span><span class="p">(</span><span class="s2">&quot;example.nl&quot;</span><span class="p">,</span><span class="s2">&quot;gravity&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">gravity</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_postnamelist</span><span class="p">(</span><span class="s2">&quot;snapshot.nl&quot;</span><span class="p">,</span><span class="s2">&quot;gravity&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">gravity</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span><span class="o">=</span><span class="n">gravity</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;PLARAD&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">radius</span><span class="o">*</span><span class="mf">6371220.0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_postnamelist</span><span class="p">(</span><span class="s2">&quot;example.nl&quot;</span><span class="p">,</span><span class="s2">&quot;radius&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">radius</span><span class="o">*</span><span class="mf">6371220.0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_postnamelist</span><span class="p">(</span><span class="s2">&quot;snapshot.nl&quot;</span><span class="p">,</span><span class="s2">&quot;radius&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">radius</span><span class="o">*</span><span class="mf">6371220.0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">=</span><span class="n">radius</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">eccentricity</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ECCEN&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">eccentricity</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eccentricity</span><span class="o">=</span><span class="n">eccentricity</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obliquity</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;OBLIQ&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">obliquity</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obliquity</span><span class="o">=</span><span class="n">obliquity</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">lonvernaleq</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;MVELP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">lonvernaleq</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lonvernaleq</span><span class="o">=</span><span class="n">lonvernaleq</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFIXORB&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">fixedorbit</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fixedorbit</span><span class="o">=</span><span class="n">fixedorbit</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">orography</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;OROSCALE&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">orography</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;glacier_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NGLACIER&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orography</span><span class="o">=</span><span class="n">orography</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NRADICE&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">seaice</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seaice</span><span class="o">=</span><span class="n">seaice</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;carbonmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NCARBON&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">co2weathering</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;carbonmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NCO2EVOLVE&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">evolveco2</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">co2weathering</span><span class="o">=</span><span class="n">co2weathering</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolveco2</span><span class="o">=</span><span class="n">evolveco2</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">erosionsupplylimit</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;carbonmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSUPPLY&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;carbonmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;WMAX&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">erosionsupplylimit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">erosionsupplylimit</span><span class="o">=</span><span class="n">erosionsupplylimit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;carbonmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;VOLCANCO2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">outgassing</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outgassing</span><span class="o">=</span><span class="n">outgassing</span>
        
        <span class="k">if</span> <span class="n">physicsfilter</span><span class="p">:</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">physicsfilter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;gp&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NGPTFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;sp&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSPVFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;none&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;cesaro&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;exp&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;lh&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">physicsfilter</span><span class="o">=</span><span class="n">physicsfilter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;FILTERKAPPA&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">filterkappa</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filterkappa</span><span class="o">=</span><span class="n">filterkappa</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFILTEREXP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">filterpower</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filterpower</span><span class="o">=</span><span class="n">filterpower</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;LANDHOSKN0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">filterLHN0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filterLHN0</span><span class="o">=</span><span class="n">filterLHN0</span>
        <span class="k">if</span> <span class="n">diffusionwaven</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NHDIFF&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">diffusionwaven</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diffusionwaven</span><span class="o">=</span><span class="n">diffusionwaven</span>
        <span class="k">if</span> <span class="n">qdiffusion</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISSQ&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">*</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span><span class="n">qdiffusion</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qdiffusion</span><span class="o">=</span><span class="n">qdiffusion</span>
        <span class="k">if</span> <span class="n">tdiffusion</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISST&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">*</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span><span class="n">tdiffusion</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tdiffusion</span><span class="o">=</span><span class="n">tdiffusion</span>
        <span class="k">if</span> <span class="n">zdiffusion</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISSZ&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">*</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span><span class="n">zdiffusion</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zdiffusion</span><span class="o">=</span><span class="n">zdiffusion</span>
        <span class="k">if</span> <span class="n">ddiffusion</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISSD&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">*</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span><span class="n">ddiffusion</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ddiffusion</span><span class="o">=</span><span class="n">ddiffusion</span>
        <span class="k">if</span> <span class="n">diffusionpower</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NDEL&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">*</span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span><span class="n">diffusionpower</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diffusionpower</span><span class="o">=</span><span class="n">diffusionpower</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="o">=</span><span class="n">glaciers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;glacier_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NGLACIER&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;glacier_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;GLACELIM&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;mindepth&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;glacier_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ICESHEETH&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;initialh&quot;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;initialh&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*174.sra </span><span class="si">%s</span><span class="s2">/*1740.sra </span><span class="si">%s</span><span class="s2">/*210.sra </span><span class="si">%s</span><span class="s2">/*232.sra&quot;</span><span class="o">%</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,]</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">snowicealbedo</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">alb</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">snowicealbedo</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ALBICE&quot;</span><span class="p">,</span><span class="n">alb</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DICEALBMN&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DICEALBMX&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSNOWALBMN&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSNOWALBMN&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DGLACALBMN&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSNOWALB&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snowicealbedo</span><span class="o">=</span><span class="n">snowicealbedo</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSIMPLEALBEDO&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">((</span><span class="ow">not</span> <span class="n">twobandalbedo</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">twobandalbedo</span><span class="o">=</span><span class="n">twobandalbedo</span>
        
        <span class="k">if</span> <span class="n">maxsnow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSMAX&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">maxsnow</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxsnow</span><span class="o">=</span><span class="n">maxsnow</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">soilalbedo</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">alb</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soilalbedo</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*0174.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ALBLAND&quot;</span><span class="p">,</span><span class="n">alb</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DGROUNDALB&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soilalbedo</span><span class="o">=</span><span class="n">soilalbedo</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">oceanalbedo</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">alb</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">oceanalbedo</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ALBSEA&quot;</span><span class="p">,</span><span class="n">alb</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DOCEANALB&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oceanalbedo</span><span class="o">=</span><span class="n">oceanalbedo</span>
        
        <span class="k">if</span> <span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;lambertian&quot;</span> <span class="ow">or</span> <span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;Lambertian&quot;</span> <span class="ow">or</span> <span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;uniform&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM6&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;default&quot;</span> <span class="ow">or</span> <span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;plasim&quot;</span> <span class="ow">or</span> <span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;ECHAM-3&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM6&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;ECHAM-6&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM6&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oceanzenith</span><span class="o">=</span><span class="n">oceanzenith</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NWETSOIL&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">wetsoil</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wetsoil</span><span class="o">=</span><span class="n">wetsoil</span>
        <span class="k">if</span> <span class="n">soilwatercap</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;WSMAX&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">soilwatercap</span><span class="p">))</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*0229.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">desertplanet</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NDESERT&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NWATCINI&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DWATCINI&quot;</span><span class="p">,</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">soilsaturation</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NWATCINI&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DWATCINI&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">soilsaturation</span><span class="p">))</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*0229.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">aquaplanet</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NAQUA&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soilwatercap</span><span class="o">=</span><span class="n">soilwatercap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soilsaturation</span><span class="o">=</span><span class="n">soilsaturation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desertplanet</span><span class="o">=</span><span class="n">desertplanet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aquaplanet</span><span class="o">=</span><span class="n">aquaplanet</span>
        
        <span class="k">if</span> <span class="n">drycore</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;fluxmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NEVAP&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drycore</span><span class="o">=</span><span class="n">drycore</span>
        
        <span class="k">if</span> <span class="n">columnmode</span><span class="p">:</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">columnmode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;static&quot;</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NADV&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;clear&quot;</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NCLOUDS&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ACLLWR&quot;</span><span class="p">,</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columnmode</span><span class="o">=</span><span class="n">columnmode</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NO3&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">ozone</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ozone</span><span class="o">=</span><span class="n">ozone</span>
        
        <span class="k">if</span> <span class="n">cpsoil</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;SOILCAP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">cpsoil</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpsoil</span> <span class="o">=</span> <span class="n">cpsoil</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dzsoils</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">6.4</span><span class="p">])</span><span class="o">*</span><span class="n">soildepth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSOILZ&quot;</span><span class="p">,</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dzsoils</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soildepth</span><span class="o">=</span><span class="n">soildepth</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;oceanmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;MLDEPTH&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">mldepth</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mldepth</span><span class="o">=</span><span class="n">mldepth</span>
        
        <span class="k">if</span> <span class="n">writefrequency</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NWPD&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">writefrequency</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writefrequency</span><span class="o">=</span><span class="n">writefrequency</span>
        
        <span class="k">if</span> <span class="n">stratosphere</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NEQSIG&quot;</span><span class="p">,</span><span class="s2">&quot;5&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">modeltop</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;PTOP2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">modeltop</span><span class="o">*</span><span class="mf">100.0</span><span class="p">))</span> <span class="c1">#convert hPa-&gt;Pa</span>
            <span class="k">if</span> <span class="n">tropopause</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;PTOP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">tropopause</span><span class="o">*</span><span class="mf">100.0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">modeltop</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;PTOP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">modeltop</span><span class="o">*</span><span class="mf">100.0</span><span class="p">))</span> <span class="c1">#convert hPa-&gt;Pa</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stratosphere</span><span class="o">=</span><span class="n">stratosphere</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeltop</span><span class="o">=</span><span class="n">modeltop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tropopause</span><span class="o">=</span><span class="n">tropopause</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;MPSTEP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">timestep</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTPW&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">7200</span><span class="o">//</span><span class="nb">int</span><span class="p">(</span><span class="n">timestep</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">runscript</span><span class="o">=</span><span class="n">runscript</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NHCADENCE&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;HCSTARTSTEP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;HCENDSTEP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;HCINTERVAL&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;interval&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="o">=</span><span class="n">highcadence</span>
        
        <span class="k">if</span> <span class="n">snapshots</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSNAPSHOT&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTPS&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">snapshots</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snapshots</span><span class="o">=</span><span class="n">snapshots</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">resources</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">/&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">=</span><span class="n">resources</span>
        
        <span class="k">if</span> <span class="n">landmap</span> <span class="ow">or</span> <span class="n">topomap</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">landmap</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">/N</span><span class="si">%03d</span><span class="s2">_surf_0172.sra&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">landmap</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nlats</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">topomap</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">/N</span><span class="si">%03d</span><span class="s2">_surf_0129.sra&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">topomap</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nlats</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">landmap</span><span class="o">=</span><span class="n">landmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topomap</span><span class="o">=</span><span class="n">topomap</span>
        
        <span class="k">if</span> <span class="n">stormclim</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;hurricane_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTORMDIAG&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_postcodes</span><span class="p">(</span><span class="s2">&quot;example.nl&quot;</span><span class="p">,[</span><span class="mi">322</span><span class="p">,</span><span class="mi">323</span><span class="p">,</span><span class="mi">324</span><span class="p">,</span><span class="mi">325</span><span class="p">,</span><span class="mi">326</span><span class="p">,</span><span class="mi">327</span><span class="p">,</span><span class="mi">328</span><span class="p">,</span><span class="mi">329</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_postcodes</span><span class="p">(</span><span class="s2">&quot;snapshot.nl&quot;</span><span class="p">,[</span><span class="mi">322</span><span class="p">,</span><span class="mi">323</span><span class="p">,</span><span class="mi">324</span><span class="p">,</span><span class="mi">325</span><span class="p">,</span><span class="mi">326</span><span class="p">,</span><span class="mi">327</span><span class="p">,</span><span class="mi">328</span><span class="p">,</span><span class="mi">329</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stormclim</span><span class="o">=</span><span class="n">stormclim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;hurricane_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTORMS&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nstorms</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nstorms</span><span class="o">=</span><span class="n">nstorms</span>
        <span class="k">if</span> <span class="n">stormcapture</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;hurricane_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;HC_CAPTURE&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">stormcapture</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span><span class="o">!=</span><span class="s2">&quot;toggle&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;hurricane_namelist&quot;</span><span class="p">,</span><span class="n">param</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">stormcapture</span><span class="p">[</span><span class="n">param</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stormcapture</span><span class="o">=</span><span class="n">stormcapture</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherargs</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">otherargs</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">otherargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">destination</span><span class="o">=</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span>
                <span class="n">field</span><span class="o">=</span><span class="n">destination</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">namelist</span><span class="o">=</span><span class="n">destination</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="n">namelist</span><span class="p">,</span><span class="n">field</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">otherargs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Model.loadconfig"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.loadconfig">[docs]</a>    <span class="k">def</span> <span class="nf">loadconfig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">configfile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;    Load a previously-exported configuration file and configure the model accordingly.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        configfile : str </span>
<span class="sd">            Path to the configuration file to load</span>
<span class="sd">            </span>
<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        exportcfg : Export model configuration to a text file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">configfile</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cfgf</span><span class="p">:</span>
            <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfgf</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">noutput</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">flux</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">startemp</span><span class="o">=</span><span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">starspec</span><span class="o">=</span><span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">gases</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">gases</span><span class="p">:</span>
            <span class="n">species</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
            <span class="n">amt</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">species</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">species</span> <span class="o">=</span> <span class="n">species</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="n">species</span><span class="p">]</span> <span class="o">=</span> <span class="n">amt</span>
        <span class="n">gascon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
        <span class="n">pressure</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">pressurebroaden</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
        <span class="n">vtype</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
        <span class="n">rotationperiod</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
        <span class="n">synchronous</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">10</span><span class="p">]))</span>
        <span class="n">substellarlon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
        <span class="n">restartfile</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">gravity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span>
        <span class="n">eccentricity</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">obliquity</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">lonvernaleq</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">fixedorbit</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">18</span><span class="p">]))</span>
        <span class="n">orography</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">19</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">seaice</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">20</span><span class="p">]))</span>
        <span class="n">co2weathering</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">21</span><span class="p">]))</span>
        <span class="n">evolveco2</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">22</span><span class="p">]))</span>
        <span class="n">physicsfilter</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">23</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">filterkappa</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">24</span><span class="p">])</span>
        <span class="n">filterpower</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">25</span><span class="p">])</span>
        <span class="n">filterLHN0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">26</span><span class="p">])</span>
        <span class="n">diffusionwaven</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">qdiffusion</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">28</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">tdiffusion</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">29</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">zdiffusion</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">ddiffusion</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">31</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">diffusionpower</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">32</span><span class="p">],</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">erosionsupplylimit</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">33</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">outgassing</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">34</span><span class="p">])</span>
        <span class="n">snowicealbedo</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">35</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">twobandalbedo</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">36</span><span class="p">]))</span>
        <span class="n">maxsnow</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">37</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">soilalbedo</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">38</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">oceanalbedo</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">39</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">oceanzenith</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="mi">40</span><span class="p">]</span>
        <span class="n">wetsoil</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">41</span><span class="p">]))</span>
        <span class="n">soilwatercap</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">42</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">aquaplanet</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">43</span><span class="p">]))</span>
        <span class="n">desertplanet</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">44</span><span class="p">]))</span>
        <span class="n">soilsaturation</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">45</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">drycore</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">46</span><span class="p">]))</span>
        <span class="n">ozone</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">47</span><span class="p">]))</span>
        <span class="n">cpsoil</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">48</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">soildepth</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">49</span><span class="p">])</span>
        <span class="n">mldepth</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">50</span><span class="p">])</span>
        <span class="n">writefrequency</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">51</span><span class="p">],</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">modeltop</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">52</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">stratosphere</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">53</span><span class="p">]))</span>
        <span class="n">tropopause</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">54</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">timestep</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">55</span><span class="p">])</span>
        <span class="n">runscript</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">56</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">columnmode</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">57</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">hcdict</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="mi">58</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)</span>
        <span class="n">highcadence</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">hc</span> <span class="ow">in</span> <span class="n">hcdict</span><span class="p">:</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
            <span class="n">highcadence</span><span class="p">[</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">snapshots</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">59</span><span class="p">],</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">resources</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">reslist</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="mi">60</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">reslist</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">reslist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">reslist</span><span class="p">:</span>
                <span class="n">resources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
        <span class="n">landmap</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">61</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">topomap</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">62</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">stormclim</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">63</span><span class="p">]))</span>
        <span class="n">nstorms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">64</span><span class="p">])</span>
        <span class="n">stormcapture</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">stormdict</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="mi">65</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">stormdict</span><span class="p">:</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;toggle&quot;</span> <span class="ow">or</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;NKTRIGGER&quot;</span> <span class="ow">or</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;SIZETHRESH&quot;</span> \
            <span class="ow">or</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;ENDTHRESH&quot;</span> <span class="ow">or</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;MINSTORMLEN&quot;</span> <span class="ow">or</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;MAXSTORMLEN&quot;</span><span class="p">:</span>
                <span class="n">stormcapture</span><span class="p">[</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stormcapture</span><span class="p">[</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">otherargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">otherdict</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherdict</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">otherdict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">otherdict</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">otherdict</span><span class="p">:</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;f&quot;</span><span class="p">:</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span>
                <span class="k">elif</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;i&quot;</span><span class="p">:</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span>
                <span class="k">elif</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;s&quot;</span><span class="p">:</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
                <span class="n">otherargs</span><span class="p">[</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">_noneparse</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">67</span><span class="p">],</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">glaciers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">glacdict</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">)</span>
        <span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">glacdict</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;mindepth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">glacdict</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;initialh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">glacdict</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="mi">69</span><span class="p">])</span>
        <span class="c1">#PAST THIS POINT ALL ADDITIONAL LOADS SHOULD BE IN TRY-EXCEPT FOR BACKWARDS COMPAT.</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">noutput</span><span class="o">=</span><span class="n">noutput</span><span class="p">,</span><span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span><span class="n">startemp</span><span class="o">=</span><span class="n">startemp</span><span class="p">,</span><span class="n">starspec</span><span class="o">=</span><span class="n">starspec</span><span class="p">,</span>
                    <span class="n">gascon</span><span class="o">=</span><span class="n">gascon</span><span class="p">,</span><span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span><span class="n">pressurebroaden</span><span class="o">=</span><span class="n">pressurebroaden</span><span class="p">,</span>
                    <span class="n">vtype</span><span class="o">=</span><span class="n">vtype</span><span class="p">,</span><span class="n">rotationperiod</span><span class="o">=</span><span class="n">rotationperiod</span><span class="p">,</span><span class="n">synchronous</span><span class="o">=</span><span class="n">synchronous</span><span class="p">,</span>
                    <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
                    <span class="n">substellarlon</span><span class="o">=</span><span class="n">substellarlon</span><span class="p">,</span><span class="n">restartfile</span><span class="o">=</span><span class="n">restartfile</span><span class="p">,</span><span class="n">gravity</span><span class="o">=</span><span class="n">gravity</span><span class="p">,</span>
                    <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span><span class="n">eccentricity</span><span class="o">=</span><span class="n">eccentricity</span><span class="p">,</span><span class="n">obliquity</span><span class="o">=</span><span class="n">obliquity</span><span class="p">,</span>
                    <span class="n">lonvernaleq</span><span class="o">=</span><span class="n">lonvernaleq</span><span class="p">,</span><span class="n">fixedorbit</span><span class="o">=</span><span class="n">fixedorbit</span><span class="p">,</span><span class="n">orography</span><span class="o">=</span><span class="n">orography</span><span class="p">,</span>
                    <span class="n">seaice</span><span class="o">=</span><span class="n">seaice</span><span class="p">,</span><span class="n">co2weathering</span><span class="o">=</span><span class="n">co2weathering</span><span class="p">,</span><span class="n">evolveco2</span><span class="o">=</span><span class="n">evolveco2</span><span class="p">,</span>
                    <span class="n">physicsfilter</span><span class="o">=</span><span class="n">physicsfilter</span><span class="p">,</span><span class="n">filterkappa</span><span class="o">=</span><span class="n">filterkappa</span><span class="p">,</span>
                    <span class="n">filterpower</span><span class="o">=</span><span class="n">filterpower</span><span class="p">,</span><span class="n">filterLHN0</span><span class="o">=</span><span class="n">filterLHN0</span><span class="p">,</span><span class="n">diffusionwaven</span><span class="o">=</span><span class="n">diffusionwaven</span><span class="p">,</span>
                    <span class="n">qdiffusion</span><span class="o">=</span><span class="n">qdiffusion</span><span class="p">,</span><span class="n">tdiffusion</span><span class="o">=</span><span class="n">tdiffusion</span><span class="p">,</span><span class="n">zdiffusion</span><span class="o">=</span><span class="n">zdiffusion</span><span class="p">,</span>
                    <span class="n">ddiffusion</span><span class="o">=</span><span class="n">ddiffusion</span><span class="p">,</span><span class="n">diffusionpower</span><span class="o">=</span><span class="n">diffusionpower</span><span class="p">,</span>
                    <span class="n">erosionsupplylimit</span><span class="o">=</span><span class="n">erosionsupplylimit</span><span class="p">,</span><span class="n">outgassing</span><span class="o">=</span><span class="n">outgassing</span><span class="p">,</span>
                    <span class="n">snowicealbedo</span><span class="o">=</span><span class="n">snowicealbedo</span><span class="p">,</span><span class="n">twobandalbedo</span><span class="o">=</span><span class="n">twobandalbedo</span><span class="p">,</span><span class="n">maxsnow</span><span class="o">=</span><span class="n">maxsnow</span><span class="p">,</span>
                    <span class="n">soilalbedo</span><span class="o">=</span><span class="n">soilalbedo</span><span class="p">,</span><span class="n">oceanalbedo</span><span class="o">=</span><span class="n">oceanalbedo</span><span class="p">,</span><span class="n">oceanzenith</span><span class="o">=</span><span class="n">oceanzenith</span><span class="p">,</span>
                    <span class="n">wetsoil</span><span class="o">=</span><span class="n">wetsoil</span><span class="p">,</span><span class="n">soilwatercap</span><span class="o">=</span><span class="n">soilwatercap</span><span class="p">,</span><span class="n">aquaplanet</span><span class="o">=</span><span class="n">aquaplanet</span><span class="p">,</span>
                    <span class="n">desertplanet</span><span class="o">=</span><span class="n">desertplanet</span><span class="p">,</span><span class="n">soilsaturation</span><span class="o">=</span><span class="n">soilsaturation</span><span class="p">,</span>
                    <span class="n">drycore</span><span class="o">=</span><span class="n">drycore</span><span class="p">,</span><span class="n">ozone</span><span class="o">=</span><span class="n">ozone</span><span class="p">,</span><span class="n">cpsoil</span><span class="o">=</span><span class="n">cpsoil</span><span class="p">,</span><span class="n">soildepth</span><span class="o">=</span><span class="n">soildepth</span><span class="p">,</span>
                    <span class="n">mldepth</span><span class="o">=</span><span class="n">mldepth</span><span class="p">,</span><span class="n">writefrequency</span><span class="o">=</span><span class="n">writefrequency</span><span class="p">,</span><span class="n">modeltop</span><span class="o">=</span><span class="n">modeltop</span><span class="p">,</span>
                    <span class="n">stratosphere</span><span class="o">=</span><span class="n">stratosphere</span><span class="p">,</span><span class="n">tropopause</span><span class="o">=</span><span class="n">tropopause</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
                    <span class="n">runscript</span><span class="o">=</span><span class="n">runscript</span><span class="p">,</span><span class="n">columnmode</span><span class="o">=</span><span class="n">columnmode</span><span class="p">,</span><span class="n">highcadence</span><span class="o">=</span><span class="n">highcadence</span><span class="p">,</span>
                    <span class="n">snapshots</span><span class="o">=</span><span class="n">snapshots</span><span class="p">,</span><span class="n">resources</span><span class="o">=</span><span class="n">resources</span><span class="p">,</span><span class="n">landmap</span><span class="o">=</span><span class="n">landmap</span><span class="p">,</span><span class="n">stormclim</span><span class="o">=</span><span class="n">stormclim</span><span class="p">,</span>
                    <span class="n">nstorms</span><span class="o">=</span><span class="n">nstorms</span><span class="p">,</span><span class="n">stormcapture</span><span class="o">=</span><span class="n">stormcapture</span><span class="p">,</span><span class="n">topomap</span><span class="o">=</span><span class="n">topomap</span><span class="p">,</span>
                    <span class="n">otherargs</span><span class="o">=</span><span class="n">otherargs</span><span class="p">,</span><span class="n">glaciers</span><span class="o">=</span><span class="n">glaciers</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>       </div>
    
<div class="viewcode-block" id="Model.modify"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.modify">[docs]</a>    <span class="k">def</span> <span class="nf">modify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify any already-configured parameters. All parameters accepted by configure() can be passed as arguments.</span>
<span class="sd">        </span>
<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        configure : Set model parameters and boundary conditions</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">setgas</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">setgascon</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">setpressure</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">changeatmo</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">changeland</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">oldpressure</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">:</span>
            <span class="n">oldpressure</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">oldpressure</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
            <span class="n">oldpressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;noutput&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NOUTPUT&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">noutput</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;flux&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;GSOL0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;startemp&quot;</span><span class="p">:</span>
                <span class="n">startemp</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">startemp</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTARTEMP&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;STARBBTEMP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">startemp</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startemp</span> <span class="o">=</span> <span class="n">startemp</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;starspec&quot;</span><span class="p">:</span>
                <span class="n">starspec</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">starspec</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span><span class="o">==</span><span class="s2">&quot;.dat&quot;</span><span class="p">:</span>
                    <span class="n">starspec</span><span class="o">=</span><span class="n">starspec</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">starspec</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTARFILE&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;STARFILE&quot;</span><span class="p">,</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="o">%</span><span class="n">starspec</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;STARFILEHR&quot;</span><span class="p">,</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">_hr.dat&#39;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">starspec</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">starspec</span> <span class="o">=</span> <span class="n">starspec</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;pH2&quot;</span><span class="p">:</span>
                <span class="n">setgas</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pH2&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pH2&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;pHe&quot;</span><span class="p">:</span>
                <span class="n">setgas</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pHe&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pHe&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;pN2&quot;</span><span class="p">:</span>
                <span class="n">setgas</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pN2&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pN2&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;pO2&quot;</span><span class="p">:</span>
                <span class="n">setgas</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pO2&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pO2&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;pCO2&quot;</span><span class="p">:</span>
                <span class="n">setgas</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pCO2&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pCO2&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;pAr&quot;</span><span class="p">:</span>
                <span class="n">setgas</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pAr&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pAr&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;pNe&quot;</span><span class="p">:</span>
                <span class="n">setgas</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pNe&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pNe&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;pKr&quot;</span><span class="p">:</span>
                <span class="n">setgas</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pKr&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pKr&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;pH20&quot;</span><span class="p">:</span>
                <span class="n">setgas</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pH2O&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s2">&quot;pH2O&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;pressure&quot;</span><span class="p">:</span>
                <span class="n">pressure</span><span class="o">=</span><span class="n">value</span>
                <span class="n">setpressure</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;gascon&quot;</span><span class="p">:</span>
                <span class="n">setgascon</span><span class="o">=</span><span class="kc">True</span>
                <span class="n">gascon</span><span class="o">=</span><span class="n">value</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;pressurebroaden&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pressurebroaden</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NPBROADEN&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pressurebroaden</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;vtype&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vtype</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NEQSIG&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtype</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;year&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sidyear</span><span class="o">=</span><span class="n">year</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidyear</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;N_DAYS_PER_YEAR&quot;</span><span class="p">,</span>
                                        <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidyear</span><span class="p">)))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;SIDEREAL_YEAR&quot;</span><span class="p">,</span>
                                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidyear</span><span class="o">*</span><span class="mf">86400.0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;rotationperiod&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rotationperiod</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotationperiod</span><span class="o">!=</span><span class="mf">1.0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ROTSPD&quot;</span><span class="p">,</span>
                                        <span class="nb">str</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotationperiod</span><span class="p">)))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;N_DAYS_PER_YEAR&quot;</span><span class="p">,</span>
                                        <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">360.0</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotationperiod</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="o">+</span><span class="mf">0.5</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">12</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;synchronous&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">synchronous</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFIXED&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">synchronous</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;substellarlon&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">substellarlon</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;FIXEDLON&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">substellarlon</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;restartfile&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">restartfile</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">restartfile</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">/plasim_restart&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">restartfile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/plasim_restart&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;gravity&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;GA&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravity</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_postnamelist</span><span class="p">(</span><span class="s2">&quot;example.nl&quot;</span><span class="p">,</span><span class="s2">&quot;gravity&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravity</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_postnamelist</span><span class="p">(</span><span class="s2">&quot;snapshot.nl&quot;</span><span class="p">,</span><span class="s2">&quot;gravity&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravity</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;radius&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;PLARAD&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">*</span><span class="mf">6371220.0</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_postnamelist</span><span class="p">(</span><span class="s2">&quot;example.nl&quot;</span><span class="p">,</span><span class="s2">&quot;radius&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">*</span><span class="mf">6371220.0</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_postnamelist</span><span class="p">(</span><span class="s2">&quot;snapshot.nl&quot;</span><span class="p">,</span><span class="s2">&quot;radius&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">*</span><span class="mf">6371220.0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;eccentricity&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eccentricity</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ECCEN&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;obliquity&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obliquity</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;OBLIQ&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obliquity</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;lonvernaleq&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lonvernaleq</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;MVELP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lonvernaleq</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;fixedorbit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fixedorbit</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFIXORB&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fixedorbit</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;orography&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">orography</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;OROSCALE&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orography</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;glacier_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NGLACIER&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">orography</span><span class="o">!=</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;seaice&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seaice</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NRADICE&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seaice</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;co2weathering&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">co2weathering</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;carbonmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NCARBON&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">co2weathering</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;evolveco2&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">evolveco2</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;carbonmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NCO2EVOLVE&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evolveco2</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;erosionsupplylimit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">erosionsupplylimit</span><span class="o">=</span><span class="n">value</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">erosionsupplylimit</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;carbonmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSUPPLY&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">flag</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;carbonmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;WMAX&quot;</span><span class="p">,</span>
                                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">erosionsupplylimit</span><span class="o">*</span><span class="n">flag</span><span class="o">+</span><span class="mf">1.0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">flag</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;outgassing&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outgassing</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;carbonmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;VOLCANCO2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outgassing</span><span class="p">))</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;physicsfilter&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">physicsfilter</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">physicsfilter</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">physicsfilter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;gp&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NGPTFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;sp&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSPVFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;none&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;cesaro&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;exp&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;lh&quot;</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NGPTFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSPVFILTER&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;filterkappa&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filterkappa</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;FILTERKAPPA&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filterkappa</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;filterpower&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filterpower</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NFILTEREXP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filterpower</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;filterLHN0&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filterLHN0</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;LANDHOSKN0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filterLHN0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;diffusionwaven&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">diffusionwaven</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NHDIFF&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusionwaven</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NHDIFF&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;qdiffusion&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qdiffusion</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISSQ&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">*</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">qdiffusion</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISSQ&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;tdiffusion&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tdiffusion</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISST&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">*</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">tdiffusion</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISST&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;zdiffusion&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">zdiffusion</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISSZ&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">*</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">zdiffusion</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISSZ&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;ddiffusion&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ddiffusion</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISSD&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">*</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">ddiffusion</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;TDISSD&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;diffusionpower&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">diffusionpower</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NDEL&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">*</span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">diffusionpower</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NDEL&quot;</span><span class="p">)</span>
                    
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;glaciers&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;glacier_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NGLACIER&quot;</span><span class="p">,</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;glacier_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;GLACELIM&quot;</span><span class="p">,</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;mindepth&quot;</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;glacier_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ICESHEETH&quot;</span><span class="p">,</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;initialh&quot;</span><span class="p">]))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;initialh&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*174.sra </span><span class="si">%s</span><span class="s2">/*1740.sra &quot;</span><span class="o">+</span>
                            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/*210.sra </span><span class="si">%s</span><span class="s2">/*232.sra&quot;</span><span class="o">%</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,]</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;snowicealbedo&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">snowicealbedo</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">snowicealbedo</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="n">alb</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">snowicealbedo</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ALBICE&quot;</span><span class="p">,</span><span class="n">alb</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DICEALBMN&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DICEALBMX&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSNOWALBMN&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSNOWALBMN&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DGLACALBMN&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSNOWALB&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ALBICE&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DICEALBMN&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DICEALBMX&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSNOWALBMN&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSNOWALBMN&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DGLACALBMN&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSNOWALB&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;twobandalbedo&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">twobandalbedo</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSIMPLEALBEDO&quot;</span><span class="p">,</span>
                                    <span class="nb">str</span><span class="p">((</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">twobandalbedo</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;maxsnow&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">maxsnow</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">maxsnow</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSMAX&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxsnow</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DSMAX&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;soilalbedo&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">soilalbedo</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soilalbedo</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="n">alb</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soilalbedo</span><span class="p">)</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*0174.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ALBLAND&quot;</span><span class="p">,</span><span class="n">alb</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DGROUNDALB&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ALBLAND&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DGROUNDALB&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;oceanalbedo&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">oceanalbedo</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oceanalbedo</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="n">alb</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oceanalbedo</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ALBSEA&quot;</span><span class="p">,</span><span class="n">alb</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DOCEANALB&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">alb</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ALBSEA&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;seamod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DOCEANALB&quot;</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;oceanzenith&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">oceanzenith</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;lambertian&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;Lambertian&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;uniform&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM6&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;default&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;plasim&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;ECHAM-3&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM6&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oceanzenith</span><span class="o">==</span><span class="s2">&quot;ECHAM-6&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NECHAM6&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;wetsoil&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wetsoil</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NWETSOIL&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wetsoil</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;soilwatercap&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">soilwatercap</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soilwatercap</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;WSMAX&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soilwatercap</span><span class="p">))</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*0229.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;WSMAX&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;soilsaturation&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">soilsaturation</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soilsaturation</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NWATCINI&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DWATCINI&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soilsaturation</span><span class="p">))</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*0229.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NWATCINI&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DWATCINI&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;desertplanet&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">desertplanet</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">desertplanet</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NDESERT&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NWATCINI&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DWATCINI&quot;</span><span class="p">,</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NDESERT&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NWATCINI&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;DWATCINI&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;aquaplanet&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">aquaplanet</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aquaplanet</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NAQUA&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NAQUA&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;drycore&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drycore</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;fluxmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NEVAP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">((</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">drycore</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;columnmode&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">columnmode</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columnmode</span><span class="p">:</span>
                    <span class="n">parts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columnmode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;static&quot;</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NADV&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NADV&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;clear&quot;</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NCLOUDS&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ACLLWR&quot;</span><span class="p">,</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NCLOUDS&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ACLLWR&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NADV&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NCLOUDS&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;ACLLWR&quot;</span><span class="p">)</span>
                    
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;ozone&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ozone</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NO3&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ozone</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;cpsoil&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cpsoil</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpsoil</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;SOILCAP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpsoil</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;SOILCAP&quot;</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;soildepth&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">soildepth</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dzsoils</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">6.4</span><span class="p">])</span><span class="o">*</span><span class="n">soildepth</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;landmod_namelist&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;DSOILZ&quot;</span><span class="p">,</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dzsoils</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)))</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;mldepth&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mldepth</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;oceanmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;MLDEPTH&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mldepth</span><span class="p">))</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;writefrequency&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">writefrequency</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writefrequency</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NWPD&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">writefrequency</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NWPD&quot;</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;modeltop&quot;</span><span class="p">:</span>
                <span class="n">changeatmo</span><span class="o">=</span><span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modeltop</span><span class="o">=</span><span class="n">value</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;stratosphere&quot;</span><span class="p">:</span>
                <span class="n">changeatmo</span><span class="o">=</span><span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stratosphere</span><span class="o">=</span><span class="n">value</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;tropopause&quot;</span><span class="p">:</span>
                <span class="n">changeatmo</span><span class="o">=</span><span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tropopause</span><span class="o">=</span><span class="n">value</span>
            
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;timestep&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;MPSTEP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTPW&quot;</span><span class="p">,</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">7200</span><span class="o">//</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">))))</span>
            
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;runscript&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">runscript</span><span class="o">=</span><span class="n">value</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;highcadence&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NHCADENCE&quot;</span><span class="p">,</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;HCSTARTSTEP&quot;</span><span class="p">,</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;HCENDSTEP&quot;</span><span class="p">,</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;HCINTERVAL&quot;</span><span class="p">,</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="s2">&quot;interval&quot;</span><span class="p">]))</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;snapshots&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">snapshots</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">snapshots</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSNAPSHOT&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTPS&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">snapshots</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_namelist_param</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTPS&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSNAPSHOT&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                    
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;resources&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">/&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">))</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;landmap&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">landmap</span><span class="o">=</span><span class="n">value</span>
                <span class="n">changeland</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;topomap&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">topomap</span><span class="o">=</span><span class="n">value</span>
                <span class="n">changeland</span><span class="o">=</span><span class="kc">True</span>
                
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;stormclim&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stormclim</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stormclim</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;hurricane_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTORMDIAG&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_postcodes</span><span class="p">(</span><span class="s2">&quot;example.nl&quot;</span><span class="p">,[</span><span class="mi">322</span><span class="p">,</span><span class="mi">323</span><span class="p">,</span><span class="mi">324</span><span class="p">,</span><span class="mi">325</span><span class="p">,</span><span class="mi">326</span><span class="p">,</span><span class="mi">327</span><span class="p">,</span><span class="mi">328</span><span class="p">,</span><span class="mi">329</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_postcodes</span><span class="p">(</span><span class="s2">&quot;snapshot.nl&quot;</span><span class="p">,[</span><span class="mi">322</span><span class="p">,</span><span class="mi">323</span><span class="p">,</span><span class="mi">324</span><span class="p">,</span><span class="mi">325</span><span class="p">,</span><span class="mi">326</span><span class="p">,</span><span class="mi">327</span><span class="p">,</span><span class="mi">328</span><span class="p">,</span><span class="mi">329</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;hurricane_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTORMDIAG&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_postcodes</span><span class="p">(</span><span class="s2">&quot;example.nl&quot;</span><span class="p">,[</span><span class="mi">322</span><span class="p">,</span><span class="mi">323</span><span class="p">,</span><span class="mi">324</span><span class="p">,</span><span class="mi">325</span><span class="p">,</span><span class="mi">326</span><span class="p">,</span><span class="mi">327</span><span class="p">,</span><span class="mi">328</span><span class="p">,</span><span class="mi">329</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rm_postcodes</span><span class="p">(</span><span class="s2">&quot;snapshot.nl&quot;</span><span class="p">,[</span><span class="mi">322</span><span class="p">,</span><span class="mi">323</span><span class="p">,</span><span class="mi">324</span><span class="p">,</span><span class="mi">325</span><span class="p">,</span><span class="mi">326</span><span class="p">,</span><span class="mi">327</span><span class="p">,</span><span class="mi">328</span><span class="p">,</span><span class="mi">329</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;nstorms&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nstorms</span><span class="o">=</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;hurricane_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NSTORMS&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">nstorms</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;stormcapture&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stormcapture</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stormcapture</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;hurricane_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;HC_CAPTURE&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stormcapture</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">param</span><span class="o">!=</span><span class="s2">&quot;toggle&quot;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;hurricane_namelist&quot;</span><span class="p">,</span><span class="n">param</span><span class="p">,</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stormcapture</span><span class="p">[</span><span class="n">param</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelsit</span><span class="p">(</span><span class="s2">&quot;hurricane_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;HC_CAPTURE&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;threshold&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">value</span>
            
            <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;otherargs&quot;</span><span class="p">:</span>
                <span class="n">otherargs</span><span class="o">=</span><span class="n">value</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherargs</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">otherargs</span><span class="p">:</span>
                        <span class="n">destination</span><span class="o">=</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span>
                        <span class="n">value</span><span class="o">=</span><span class="n">otherargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="n">field</span><span class="o">=</span><span class="n">destination</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">namelist</span><span class="o">=</span><span class="n">destination</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="n">namelist</span><span class="p">,</span><span class="n">field</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">otherargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
                
        <span class="k">if</span> <span class="n">setgas</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="n">setpressure</span><span class="p">:</span>
                <span class="n">newpressure</span><span class="o">=</span><span class="n">pressure</span>
            
            <span class="n">pressure</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">:</span>
                <span class="n">pressure</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span>
            
            <span class="n">pscalef</span> <span class="o">=</span> <span class="n">pressure</span><span class="o">/</span><span class="n">oldpressure</span>
            
            <span class="n">gasesvx</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">:</span>
                <span class="n">gasesvx</span><span class="p">[</span><span class="n">gas</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span><span class="o">/</span><span class="n">pressure</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mmw</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">gasesvx</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mmw</span> <span class="o">+=</span> <span class="n">gasesvx</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span><span class="o">*</span><span class="n">smws</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="o">+</span><span class="n">gas</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gascon</span> <span class="o">=</span> <span class="mf">8314.46261815324</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mmw</span>
            
            <span class="k">if</span> <span class="n">setgascon</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gascon</span><span class="o">=</span><span class="n">gascon</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mmw</span> <span class="o">=</span> <span class="mf">8314.46261815324</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">gascon</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Molecular Weight set to </span><span class="si">%1.4f</span><span class="s1"> g/mol&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">mmw</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">setpressure</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="o">=</span><span class="n">newpressure</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span> <span class="o">*=</span> <span class="n">pscalef</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Surface Pressure set to </span><span class="si">%1.6f</span><span class="s2"> bars&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;PSURF&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="o">*</span><span class="mf">1.0e5</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;planet_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;GASCON&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gascon</span><span class="p">))</span>
            
                
            <span class="k">if</span> <span class="s1">&#39;pCO2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">CO2ppmv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="s1">&#39;pCO2&#39;</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span> <span class="o">*</span> <span class="mf">1.0e6</span> <span class="c1">#ppmv</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;radmod_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;CO2&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">CO2ppmv</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">setpressure</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;PSURF&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="p">))</span>
            
        <span class="k">if</span> <span class="n">changeatmo</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stratosphere</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;NEQSIG&quot;</span><span class="p">,</span><span class="s2">&quot;5&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeltop</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;PTOP2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeltop</span><span class="o">*</span><span class="mf">100.0</span><span class="p">))</span> 
                        <span class="c1">#convert hPa-&gt;Pa</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tropopause</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;PTOP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tropopause</span><span class="o">*</span><span class="mf">100.0</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeltop</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_edit_namelist</span><span class="p">(</span><span class="s2">&quot;plasim_namelist&quot;</span><span class="p">,</span><span class="s2">&quot;PTOP&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeltop</span><span class="o">*</span><span class="mf">100.0</span><span class="p">))</span> 
                        <span class="c1">#convert hPa-&gt;Pa</span>
                    
        <span class="k">if</span> <span class="n">changeland</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">landmap</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">topomap</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm </span><span class="si">%s</span><span class="s2">/*.sra&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">landmap</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">/N</span><span class="si">%03d</span><span class="s2">_surf_0172.sra&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">landmap</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nlats</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">topomap</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cp </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">/N</span><span class="si">%03d</span><span class="s2">_surf_0129.sra&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topomap</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nlats</span><span class="p">))</span></div>
    
<div class="viewcode-block" id="Model.save"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the current Model object to a NumPy save file. </span>

<span class="sd">        The model object can then be reinstantiated using ``numpy.load(savefile).item()``. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str, optional</span>
<span class="sd">            Filename to save to. If unspecified, will default to &lt;modelname&gt;.npy.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Note that these files are often not portable between versions of Python or machine architectures, so their use is only recommended internally. For sharing with other</span>
<span class="sd">        users, it is recommended that you use the ``.exportcfg()`` function.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        exportcfg : Export model configuration to a portable text file.</span>

<span class="sd">&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">filename</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/model.npy&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="Model.exportcfg"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Model.exportcfg">[docs]</a>    <span class="k">def</span> <span class="nf">exportcfg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Export model configuration to a text file that can be used as configuration input</span>

<span class="sd">        Write the current model configuration to a text file. This file can be shared and used by</span>
<span class="sd">        other users to recreate your model configuration.</span>
<span class="sd">            </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str, optional </span>
<span class="sd">            Path to the file that should be written. If None (default), &lt;modelname&gt;.cfg</span>
<span class="sd">            will be created in the working directory.</span>
<span class="sd">            </span>
<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        loadconfig : Load a saved configuration.</span>
<span class="sd">&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">modelname</span><span class="o">+</span><span class="s2">&quot;.cfg&quot;</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noutput</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startemp</span><span class="p">))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">starspec</span><span class="p">))</span><span class="c1">#=_noneparse(cfg[3],str)</span>
        <span class="n">gases</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">:</span>
            <span class="n">gases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gas</span><span class="o">+</span><span class="s2">&quot;|&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pgases</span><span class="p">[</span><span class="n">gas</span><span class="p">]))</span>
        <span class="n">gases</span> <span class="o">=</span> <span class="s2">&quot;&amp;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gases</span><span class="p">)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gases</span><span class="p">)</span><span class="c1"># = cfg[4].split(&quot;&amp;&quot;)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gascon</span><span class="p">))</span><span class="c1"># = float(cfg[5])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span><span class="p">))</span><span class="c1"># = float(cfg[6])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pressurebroaden</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[7]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtype</span><span class="p">))</span><span class="c1"># = int(cfg[8])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotationperiod</span><span class="p">))</span><span class="c1"># = float(cfg[9])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">synchronous</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[10]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">substellarlon</span><span class="p">))</span><span class="c1"># = float(cfg[11])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">restartfile</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[12],str)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravity</span><span class="p">))</span><span class="c1"># = float(cfg[13])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">))</span><span class="c1"># = float(cfg[14])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[15],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obliquity</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[16],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lonvernaleq</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[17],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fixedorbit</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[18]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orography</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[19],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seaice</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[20]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">co2weathering</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[21]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evolveco2</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[22]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">physicsfilter</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[23],str)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filterkappa</span><span class="p">))</span><span class="c1"># = float(cfg[24])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filterpower</span><span class="p">))</span><span class="c1"># = int(cfg[25])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filterLHN0</span><span class="p">))</span><span class="c1"># = float(cfg[26])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusionwaven</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[27],int)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qdiffusion</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[28],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tdiffusion</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[29],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zdiffusion</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[30],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ddiffusion</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[31],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusionpower</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[32],int)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">erosionsupplylimit</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[33],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outgassing</span><span class="p">))</span><span class="c1"># = float(cfg[34])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">snowicealbedo</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[35],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">twobandalbedo</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[36]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxsnow</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[37],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soilalbedo</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[38],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oceanalbedo</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[39],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oceanzenith</span><span class="p">))</span><span class="c1"># = cfg[40]</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wetsoil</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[41]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soilwatercap</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[42],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aquaplanet</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[43]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desertplanet</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[44]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soilsaturation</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[45],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drycore</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[46]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ozone</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[47]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpsoil</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[48],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soildepth</span><span class="p">))</span><span class="c1"># = float(cfg[49])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mldepth</span><span class="p">))</span><span class="c1"># = float(cfg[50])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">writefrequency</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[51],int)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeltop</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[52],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stratosphere</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[53]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tropopause</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[54],float)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">))</span><span class="c1"># = float(cfg[55])</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runscript</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[56],str)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columnmode</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[57],str)</span>
        <span class="n">hcdict</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">hc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">:</span>
            <span class="n">hcdict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hc</span><span class="o">+</span><span class="s2">&quot;|&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">highcadence</span><span class="p">[</span><span class="n">hc</span><span class="p">]))</span>
        <span class="n">hcdict</span> <span class="o">=</span> <span class="s2">&quot;&amp;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">hcdict</span><span class="p">)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hcdict</span><span class="p">)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">snapshots</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[59],int)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">landmap</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[61],str)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topomap</span><span class="p">))</span><span class="c1"># = _noneparse(cfg[62],str)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stormclim</span><span class="o">*</span><span class="mi">1</span><span class="p">))</span><span class="c1"># = bool(int(cfg[63]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nstorms</span><span class="p">))</span><span class="c1"># = int(cfg[64])</span>
        <span class="n">stormdict</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stormcapture</span><span class="p">:</span>
            <span class="n">stormdict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="o">+</span><span class="s2">&quot;|&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stormcapture</span><span class="p">[</span><span class="n">arg</span><span class="p">]))</span>
        <span class="n">stormdict</span> <span class="o">=</span> <span class="s2">&quot;&amp;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">stormdict</span><span class="p">)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stormdict</span><span class="p">)</span>
        <span class="n">otherdict</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">otherargs</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arg</span><span class="o">+</span><span class="s2">&quot;|&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">otherargs</span><span class="p">[</span><span class="n">arg</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">otherargs</span><span class="p">[</span><span class="n">arg</span><span class="p">])</span><span class="o">==</span><span class="nb">int</span><span class="p">:</span>
                <span class="n">item</span><span class="o">+=</span><span class="s2">&quot;~i&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">otherargs</span><span class="p">[</span><span class="n">arg</span><span class="p">])</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span>
                <span class="n">item</span><span class="o">+=</span><span class="s2">&quot;~s&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">otherargs</span><span class="p">[</span><span class="n">arg</span><span class="p">])</span><span class="o">==</span><span class="nb">float</span><span class="p">:</span>
                <span class="n">item</span><span class="o">+=</span><span class="s2">&quot;~f&quot;</span>
            <span class="n">otherdict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">otherdict</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidyear</span><span class="p">:</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidyear</span><span class="o">*</span><span class="mf">86400.0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidyear</span><span class="p">))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;toggle&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="p">),</span>
                            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;mindepth&quot;</span><span class="p">]),</span>
                            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glaciers</span><span class="p">[</span><span class="s2">&quot;initialh&quot;</span><span class="p">])]))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cfgf</span><span class="p">:</span>
            <span class="n">cfgf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cfg</span><span class="p">))</span></div>
        
    <span class="k">def</span> <span class="nf">_rm_namelist_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">namelist</span><span class="p">,</span><span class="n">arg</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove an argument from a namelist&quot;&quot;&quot;</span>
        
        <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">namelist</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">fnl</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">found</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">fnl1</span><span class="o">=</span><span class="n">fnl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">fnl1</span><span class="p">:</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;EQ&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;CM&#39;</span>
        <span class="c1">#print fnl1</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">fnl1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">fnl1</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;,&quot;</span><span class="p">:</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;EQ&#39;</span>
        
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">fnl</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">=</span><span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">]:</span>
                <span class="n">found</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">arg</span><span class="o">+</span><span class="s1">&#39;=&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">]:</span>
                <span class="n">found</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                <span class="n">fnl</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
                <span class="k">break</span>
                
        <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">namelist</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fnl</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            
    <span class="k">def</span> <span class="nf">_edit_namelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">namelist</span><span class="p">,</span><span class="n">arg</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Either edit or add argument/value pair to a namelist&quot;&quot;&quot;</span>
        
        <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">namelist</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">fnl</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">found</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">fnl1</span><span class="o">=</span><span class="n">fnl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">fnl1</span><span class="p">:</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;EQ&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;CM&#39;</span>
        <span class="c1">#print fnl1</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">fnl1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">fnl1</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;,&quot;</span><span class="p">:</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;EQ&#39;</span>
        
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">fnl</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">=</span><span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">]:</span>
                <span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">arg</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">),</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
                <span class="n">found</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">arg</span><span class="o">+</span><span class="s1">&#39;=&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">]:</span>
                <span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">k</span><span class="o">=-</span><span class="mi">1</span>
                <span class="k">while</span> <span class="n">item</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">k</span><span class="o">-=</span><span class="mi">1</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;,&#39;</span><span class="p">:</span>
                    <span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">arg</span><span class="o">+</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">),</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">tag</span><span class="p">]</span>
                <span class="n">found</span><span class="o">=</span><span class="kc">True</span>
            <span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fnl</span><span class="p">[</span><span class="n">l</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;EQ&#39;</span><span class="p">:</span>
                <span class="n">fnl</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">arg</span><span class="o">+</span><span class="s1">&#39; = &#39;</span><span class="o">+</span><span class="n">val</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fnl</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">arg</span><span class="o">+</span><span class="s1">&#39;= &#39;</span><span class="o">+</span><span class="n">val</span><span class="o">+</span><span class="s1">&#39; ,&#39;</span><span class="p">)</span>
            
        <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">namelist</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fnl</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">_edit_postnamelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">namelist</span><span class="p">,</span><span class="n">arg</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Edit postprocessing namelist&quot;&quot;&quot;</span>
        
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">namelist</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pnl</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            
        <span class="n">flag</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">pnl</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">pnl</span> <span class="k">if</span> <span class="n">y</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pnl</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">pnl</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">==</span><span class="n">arg</span><span class="p">:</span>
                <span class="n">pnl</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">arg</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">+</span><span class="n">val</span>
                <span class="n">flag</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
            <span class="n">pnl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="o">+</span><span class="s1">&#39;=&#39;</span><span class="o">+</span><span class="n">val</span><span class="p">)</span>
        <span class="n">pnl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">namelist</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pnl</span><span class="p">))</span>
            
    <span class="k">def</span> <span class="nf">_add_postcodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">namelist</span><span class="p">,</span><span class="n">newcodes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add postprocessor codes to postprocessor namelist&quot;&quot;&quot;</span>
        
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">namelist</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pnl</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">pnl</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">pnl</span> <span class="k">if</span> <span class="n">y</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pnl</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">pnl</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;code&quot;</span><span class="p">:</span>
                <span class="n">codes</span> <span class="o">=</span> <span class="n">pnl</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="n">lineno</span><span class="o">=</span><span class="n">n</span>
                <span class="k">break</span>
        <span class="n">ncodes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">codes</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">newcodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ncodes</span><span class="p">:</span>
                <span class="n">ncodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">pnl</span><span class="p">[</span><span class="n">lineno</span><span class="p">]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ncodes</span><span class="p">])</span>
        <span class="c1">#print &quot;Writing to %s/%s: \n&quot;%(home,filename)+&#39;\n&#39;.join(pnl)+&quot;\n&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">namelist</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pnl</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rm_postcodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">namelist</span><span class="p">,</span><span class="n">rmcodes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add postprocessor codes to postprocessor namelist&quot;&quot;&quot;</span>
        
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">namelist</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pnl</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">pnl</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">pnl</span> <span class="k">if</span> <span class="n">y</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pnl</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">pnl</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;code&quot;</span><span class="p">:</span>
                <span class="n">codes</span> <span class="o">=</span> <span class="n">pnl</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="n">lineno</span><span class="o">=</span><span class="n">n</span>
                <span class="k">break</span>
        <span class="n">ncodes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">codes</span><span class="p">]</span>
        
        <span class="n">newcodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ncodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rmcodes</span><span class="p">:</span>
                <span class="n">newcodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">pnl</span><span class="p">[</span><span class="n">lineno</span><span class="p">]</span><span class="o">+=</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">newcodes</span><span class="p">])</span>
        <span class="c1">#print &quot;Writing to %s/%s: \n&quot;%(home,filename)+&#39;\n&#39;.join(pnl)+&quot;\n&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">namelist</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pnl</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="TLaquaplanet"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.TLaquaplanet">[docs]</a><span class="k">class</span> <span class="nc">TLaquaplanet</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a tidally-locked planet with no land.</span>

<span class="sd">    Identical to Model, except configuration options suitable for</span>
<span class="sd">    tidally-locked models are the default when configure() is called,</span>
<span class="sd">    and the surface is entirely ocean-covered. Specifically, a 30-minute</span>
<span class="sd">    timestep, snapshot outputs every 720 timesteps, eccentricity=0.0,</span>
<span class="sd">    0-degree obliquity, exponential physics filtering, fixed orbital</span>
<span class="sd">    parameters, and no ozone. All these defaults can be overridden.</span>
<span class="sd">&quot;&quot;&quot;</span>
<div class="viewcode-block" id="TLaquaplanet.configure"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.TLaquaplanet.configure">[docs]</a>    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span><span class="n">snapshots</span><span class="o">=</span><span class="mi">720</span><span class="p">,</span><span class="n">eccentricity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ozone</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">obliquity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">physicsfilter</span><span class="o">=</span><span class="s2">&quot;gp|exp|sp&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TLaquaplanet</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">synchronous</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">fixedorbit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">aquaplanet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">eccentricity</span><span class="o">=</span><span class="n">eccentricity</span><span class="p">,</span><span class="n">obliquity</span><span class="o">=</span><span class="n">obliquity</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
                        <span class="n">snapshots</span><span class="o">=</span><span class="n">snapshots</span><span class="p">,</span><span class="n">physicsfilter</span><span class="o">=</span><span class="n">physicsfilter</span><span class="p">,</span><span class="n">ozone</span><span class="o">=</span><span class="n">ozone</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
        
<div class="viewcode-block" id="TLlandplanet"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.TLlandplanet">[docs]</a><span class="k">class</span> <span class="nc">TLlandplanet</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span> <span class="c1">#Default will be ZERO soil water; set soilsaturation if you want any</span>
    <span class="sd">&quot;&quot;&quot;Create a tidally-locked model with no oceans.</span>

<span class="sd">    Identical to Model, except configuration options suitable for</span>
<span class="sd">    tidally-locked models are the default when configure() is called,</span>
<span class="sd">    and the surface is entirely land-covered. Specifically, a 30-minute</span>
<span class="sd">    timestep, snapshot outputs every 720 timesteps, eccentricity=0.0,</span>
<span class="sd">    0-degree obliquity, exponential physics filtering, fixed orbital</span>
<span class="sd">    parameters, and no ozone. All these defaults can be overridden.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The default is to include zero soil water initially. This will result in a completely dry</span>
<span class="sd">    model. Set soilsaturation to something nonzero if you want groundwater.</span>
<span class="sd">&quot;&quot;&quot;</span>
<div class="viewcode-block" id="TLlandplanet.configure"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.TLlandplanet.configure">[docs]</a>    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span><span class="n">snapshots</span><span class="o">=</span><span class="mi">720</span><span class="p">,</span><span class="n">eccentricity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ozone</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">obliquity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">physicsfilter</span><span class="o">=</span><span class="s2">&quot;gp|exp|sp&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TLlandplanet</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">synchronous</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">fixedorbit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">desertplanet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">eccentricity</span><span class="o">=</span><span class="n">eccentricity</span><span class="p">,</span><span class="n">obliquity</span><span class="o">=</span><span class="n">obliquity</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
                        <span class="n">snapshots</span><span class="o">=</span><span class="n">snapshots</span><span class="p">,</span><span class="n">physicsfilter</span><span class="o">=</span><span class="n">physicsfilter</span><span class="p">,</span><span class="n">ozone</span><span class="o">=</span><span class="n">ozone</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
        
<div class="viewcode-block" id="Earthlike"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Earthlike">[docs]</a><span class="k">class</span> <span class="nc">Earthlike</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create an Earth-like model, but more flexible.</span>

<span class="sd">    Identical to Model, except configuration options common for</span>
<span class="sd">    Earth-like models requiring slightly more flexibility are </span>
<span class="sd">    the default when configure is called--specifically, 45-minute </span>
<span class="sd">    timestep, snapshot output reporting every 480 timesteps, and </span>
<span class="sd">    a model top pinned to 50 mbar. All these defaults can be overridden.</span>
<span class="sd">&quot;&quot;&quot;</span>
<div class="viewcode-block" id="Earthlike.configure"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.Earthlike.configure">[docs]</a>    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="mf">45.0</span><span class="p">,</span><span class="n">snapshots</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Earthlike</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">vtype</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">modeltop</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
                        <span class="n">snapshots</span><span class="o">=</span><span class="n">snapshots</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="TLmodel"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.TLmodel">[docs]</a><span class="k">class</span> <span class="nc">TLmodel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a tidally-locked model.    </span>

<span class="sd">    Identical to exoplasim.Model, except configuration options suitable for</span>
<span class="sd">    tidally-locked models are the default when configure() is called.</span>
<span class="sd">&quot;&quot;&quot;</span>
<div class="viewcode-block" id="TLmodel.configure"><a class="viewcode-back" href="../source/exoplasim.html#exoplasim.TLmodel.configure">[docs]</a>    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span><span class="n">snapshots</span><span class="o">=</span><span class="mi">720</span><span class="p">,</span><span class="n">eccentricity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ozone</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">obliquity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">physicsfilter</span><span class="o">=</span><span class="s2">&quot;gp|exp|sp&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TLmodel</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">synchronous</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">fixedorbit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">eccentricity</span><span class="o">=</span><span class="n">eccentricity</span><span class="p">,</span><span class="n">obliquity</span><span class="o">=</span><span class="n">obliquity</span><span class="p">,</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
                        <span class="n">snapshots</span><span class="o">=</span><span class="n">snapshots</span><span class="p">,</span><span class="n">physicsfilter</span><span class="o">=</span><span class="n">physicsfilter</span><span class="p">,</span><span class="n">ozone</span><span class="o">=</span><span class="n">ozone</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
    
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Adiv Paradise

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>